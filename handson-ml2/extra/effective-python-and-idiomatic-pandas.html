
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Effective Python and idiomatic pandas &#8212; Data Science Foundation Curriculum</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://jads-nl.github.io/data-science-foundation-curriculum/handson-ml2/extra/effective-python-and-idiomatic-pandas.html" />
    <link rel="shortcut icon" href="../../_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Math primer - Linear Algebra" href="../original/math_linear_algebra.html" />
    <link rel="prev" title="Overfitting vs. underfitting" href="overfitting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/jads-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Science Foundation Curriculum</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   Why this JupyterBook?
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Statistical Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../islr/introduction.html">
   Introduction to ISLRv2
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../islr/labs.html">
   Labs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_02.3_introduction.html">
     Lab 2.3: Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_03.6_linear_regression.html">
     Lab 3.6: Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_04.7_classification_methods.html">
     Lab 4.7: Classification Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_05.3_cross_validation_and_the_bootstrap.html">
     Lab 5.3: Cross-Validation and the Bootstrap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_06.5.1_subset_selection_methods.html">
     Lab 6.5.1: Subset Selection Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_06.5.2_ridge_regression_and_the_lasso.html">
     Lab 6.5.2: Ridge Regression and the Lasso
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_06.5.3_pcr_and_pls_regression.html">
     Lab 6.5.3: PCR and PLS Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_07.8_non_linear_modelling.html">
     Lab 7.8: Non-linear Modeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_08.3_decision_trees.html">
     Lab 8.3: Decision Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_09.6_support_vector_machines.html">
     Lab 9.6: Support Vector Machines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_10.9.2_multilayer_network_on_mnist_digit_data.html">
     Lab 10.9.2: A Multilayer Network on the MNIST Digit Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_10.9.3_convolutional_neural_networks.html">
     Lab 10.9.3: Convolutional Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_10.9.5_imdb_document_classification.html">
     Lab 10.9.5: IMDb Document Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_10.9.6_recurrent_neural_networks.html">
     Lab 10.9.6: Recurrent Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../islr/labs/lab_12.5_unsupervised_learning.html">
     Lab 12.5: Unsupervised Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../islr/exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter2/index.html">
     Chapter 2
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise1.html">
       Exercise 2.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise2.html">
       Exercise 2.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise3.html">
       Exercise 2.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise4.html">
       Exercise 2.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise5.html">
       Exercise 2.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise6.html">
       Exercise 2.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise7.html">
       Exercise 2.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise8.html">
       Exercise 2.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise9.html">
       Exercise 2.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter2/exercise10.html">
       Exercise 2.10
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter3/index.html">
     Chapter 3
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise1.html">
       Exercise 3.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise2.html">
       Exercise 3.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise3.html">
       Exercise 3.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise4.html">
       Exercise 3.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise5.html">
       Exercise 3.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise6.html">
       Exercise 3.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise7.html">
       Exercise 3.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise8.html">
       Exercise 3.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise9.html">
       Exercise 3.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise10.html">
       Exercise 3.10
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise11.html">
       Exercise 3.11
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise12.html">
       Exercise 3.12
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise13.html">
       Exercise 3.13
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise14.html">
       Exercise 3.14
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter3/exercise15.html">
       Exercise 3.15
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter4/index.html">
     Chapter 4
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise1.html">
       Exercise 4.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise2.html">
       Exercise 4.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise3.html">
       Exercise 4.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise4.html">
       Exercise 4.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise5.html">
       Exercise 4.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise6.html">
       Exercise 4.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise7.html">
       Exercise 4.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise8.html">
       Exercise 4.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise9.html">
       Exercise 4.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise10.html">
       Exercise 10
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise11.html">
       Exercise 11
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise12.html">
       Exercise 12
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise13.html">
       Exercise 4.13
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise14.html">
       Exercise 4.11
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise15.html">
       Exercise 4.12
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter4/exercise16.html">
       Exercise 4.16
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter5/index.html">
     Chapter 5
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise1.html">
       Exercise 5.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise2.html">
       Exercise 5.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise3.html">
       Problem 5.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise4.html">
       Exercise 5.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise5.html">
       Exercise 5.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise6.html">
       Exercise 5.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise7.html">
       Exercise 5.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise8.html">
       Exercise 5.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter5/exercise9.html">
       Exercise 5.9
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter6/index.html">
     Chapter 6
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise1.html">
       Exercise 6.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise2.html">
       Exercise 6.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise3.html">
       Exercise 6.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise4.html">
       Exercise 6.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise5.html">
       Exercise 6.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise6.html">
       Exercise 6.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise7.html">
       Exercise 6.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise8.html">
       Exercise 6.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise9.html">
       Exercise 6.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise10.html">
       Exercise 6.10
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter6/exercise11.html">
       Exercise 6.11
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter7/index.html">
     Chapter 7
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise1.html">
       Exercise 7.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise2.html">
       Exercise 7.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise3.html">
       Exercise 7.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise4.html">
       Exercise 7.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise5.html">
       Exercise 7.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise6.html">
       Exercise 7.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise7.html">
       Exercise 7.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise8.html">
       Exercise 7.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise9.html">
       Exercise 7.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise10.html">
       Exercise 7.10
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise11.html">
       Exercise 7.11
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter7/exercise12.html">
       Exercise 7.12
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter8/index.html">
     Chapter 8
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise1.html">
       Exercise 8.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise2.html">
       Exercise 8.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise3.html">
       Exercise 8.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise4.html">
       Exercise 8.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise5.html">
       Exercise 8.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise6.html">
       Exercise 8.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise7.html">
       Exercise 8.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise8.html">
       Exercise 8.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise9.html">
       Exercise 8.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise10.html">
       Exercise 8.10
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise11.html">
       Exercise 8.11
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter8/exercise12.html">
       Exercise 8.12
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter9/index.html">
     Chapter 9
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise1.html">
       Exercise 9.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise2.html">
       Exercise 9.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise3.html">
       Exercise 9.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise4.html">
       Exercise 9.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise5.html">
       Exercise 9.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise6.html">
       Exercise 9.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise7.html">
       Exercise 9.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter9/exercise8.html">
       Exercise 9.8
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../islr/exercises/chapter12/index.html">
     Chapter 12
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise1.html">
       Exercise 12.1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise2.html">
       Exercise 12.2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise3.html">
       Exercise 12.3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise4.html">
       Exercise 12.4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise5.html">
       Exercise 12.5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise6.html">
       Exercise 12.6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise7.html">
       Exercise 12.7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise8.html">
       Exercise 10.8
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise9.html">
       Exercise 12.9
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise10.html">
       Exercise 12.10
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../islr/exercises/chapter12/exercise11.html">
       Exercise 12.11
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Hands-on Machine Learning in Python
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../introduction.html">
   Hands-on Machine Learning with Aurélien Géron
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/01_the_machine_learning_landscape.html">
     Chapter 1 – The Machine Learning landscape
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/02_end_to_end_machine_learning_project.html">
     Chapter 2 – End-to-end Machine Learning project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/03_classification.html">
     Chapter 3 – Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/04_training_linear_models.html">
     Chapter 4 – Training Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/05_support_vector_machines.html">
     Chapter 5 – Support Vector Machines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/06_decision_trees.html">
     Chapter 6 – Decision Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/07_ensemble_learning_and_random_forests.html">
     Chapter 7 – Ensemble Learning and Random Forests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/08_dimensionality_reduction.html">
     Chapter 8 – Dimensionality Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/09_unsupervised_learning.html">
     Chapter 9 – Unsupervised Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/10_neural_nets_with_keras.html">
     Chapter 10 – Introduction to Artificial Neural Networks with Keras
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/11_training_deep_neural_networks.html">
     Chapter 11 – Training Deep Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/12_custom_models_and_training_with_tensorflow.html">
     Chapter 12 – Custom Models and Training with TensorFlow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/13_loading_and_preprocessing_data.html">
     Chapter 13 – Loading and Preprocessing Data with TensorFlow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/14_deep_computer_vision_with_cnns.html">
     Chapter 14 – Deep Computer Vision Using Convolutional Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/15_processing_sequences_using_rnns_and_cnns.html">
     Chapter 15 – Processing Sequences Using RNNs and CNNs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/16_nlp_with_rnns_and_attention.html">
     Chapter 16 – Natural Language Processing with RNNs and Attention**
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/17_autoencoders_and_gans.html">
     Chapter 17 – Autoencoders and GANs**
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/18_reinforcement_learning.html">
     Chapter 18 – Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/19_training_and_deploying_at_scale.html">
     Chapter 19 – Training and Deploying TensorFlow Models at Scale
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../extra.html">
   Miscellaneous tips &amp; tricks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="overfitting.html">
     Overfitting vs. underfitting
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Effective Python and idiomatic pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/math_linear_algebra.html">
     Math primer - Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/math_differential_calculus.html">
     Math primer - Differential Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/extra_autodiff.html">
     Implementation of autodiff techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../original/extra_gradient_descent_comparison.html">
     Comparison of Batch, Mini-Batch and Stochastic Gradient Descent
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../projects.html">
   Discover projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas-profiling.html">
     Pandas profiling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ames-housing.html">
     Ames Housing case - examples of possible solutions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pima-indians-diabetes.html">
     Pima Indians Diabetes
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data visualization with Altair
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/introduction-to-interactive-data-visualization.html">
   Introduction to data visualization with Python
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../visualization/altair_get_started.html">
   Getting Started with Altair
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_introduction.html">
     Introduction to Altair
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_marks_encoding.html">
     Data Types, Graphical Marks, and Visual Encoding Channels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_data_transformation.html">
     Data Transformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_scales_axes_legends.html">
     Scales, Axes, and Legends
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_view_composition.html">
     Multi-View Composition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_interaction.html">
     Interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_cartographic.html">
     Cartographic Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../visualization/altair_debugging.html">
     Altair Debugging Guide
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Interpretable Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../iml/introduction.html">
   Introduction to IML
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../iml/plot_partial_dependence.html">
     Partial Dependence and Individual Conditional Expectation Plots
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../iml/plot_permutation_importance.html">
     Permutation Importance vs Random Forest Feature Importance (MDI)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../iml/plot_permutation_importance_multicollinear.html">
     Permutation Importance with Multicollinear or Correlated Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../iml/interpreting-machine-learning-models.html">
     IML with Pima Indians and the Titanic datasets
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Principles of time-series forecasting
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../fpp/introduction.html">
   Introduction to FPP3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fpp/examples-time-series-forecasting-with-python.html">
   Examples of time-series forecasting with Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Natural language processing with spaCy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../nlp/introduction.html">
   Introduction to NLP with spaCy
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../nlp/dutch-restaurant-reviews.html">
   Dutch restaurant reviews
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../nlp/nlp-dutch-restaurant-reviews.html">
     Analyzing Dutch restaurant reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../nlp/prepare-restoreviews-dataset.html">
     Fetch and prepare reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../nlp/nlp-pipeline-example.html">
     Predict detractors from reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../nlp/language-detection-with-character-quadgrams.html">
     Extra: language detection with character quadgrams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../nlp/nlp-model-sizes.html">
     Extra: plot of transformer model sizes
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/handson-ml2/extra/effective-python-and-idiomatic-pandas.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jads-nl/data-science-foundation-curriculum"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jads-nl/data-science-foundation-curriculum/issues/new?title=Issue%20on%20page%20%2Fhandson-ml2/extra/effective-python-and-idiomatic-pandas.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jads-nl/data-science-foundation-curriculum/main?urlpath=tree/data_science_foundation_curriculum/handson-ml2/extra/effective-python-and-idiomatic-pandas.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/jads-nl/data-science-foundation-curriculum/blob/main/data_science_foundation_curriculum/handson-ml2/extra/effective-python-and-idiomatic-pandas.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-functional-approach-to-python">
     A functional approach to Python
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#structure-of-notebook">
     Structure of notebook
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pythonic-thinking">
   Pythonic thinking
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#follow-the-pep-8-style-guide-ep-2">
     #1. Follow the PEP-8 style guide (EP #2)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#whitespace">
       Whitespace
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naming">
       Naming
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#expressions-and-statements">
       Expressions and Statements
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#imports">
       Imports
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-code-formatters">
       Use code formatters
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-interpolated-f-strings-over-c-style-formatting-ep-4">
     #2. Prefer interpolated f-strings over C-style formatting (EP #4)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-helper-functions-instead-of-complex-expressions-ep-5">
     #3. Write helper functions instead of complex expressions (EP #5)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-multiple-assignment-unpacking-over-indexing-ep-6">
     #4. Prefer multiple assignment unpacking over indexing (EP #6)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-enumerate-over-range-ep-7">
     #5. Prefer
     <code class="docutils literal notranslate">
      <span class="pre">
       enumerate
      </span>
     </code>
     over
     <code class="docutils literal notranslate">
      <span class="pre">
       range
      </span>
     </code>
     (EP #7)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-zip-to-process-iterators-in-parallel-ep-8">
     #6. Use zip to process iterators in parallel (EP #8)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lists-dictionairies-and-dataclasses">
   Lists, dictionairies and dataclasses
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-dataclass-if-you-need-to-create-a-data-container">
     #7. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       dataclass
      </span>
     </code>
     if you need to create a data container
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-catch-all-unpacking-over-slicing-ep-13">
     #8. Prefer catch-all unpacking over slicing (EP #13)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sort-by-complex-criteria-using-the-key-parameter-ep-14">
     #9. Sort by complex criteria using the
     <code class="docutils literal notranslate">
      <span class="pre">
       key
      </span>
     </code>
     parameter (EP #14)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-get-over-in-and-keyerror-to-handle-missing-dictionairy-keys-ep-16">
     #10. Prefer
     <code class="docutils literal notranslate">
      <span class="pre">
       get
      </span>
     </code>
     over
     <code class="docutils literal notranslate">
      <span class="pre">
       in
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       KeyError
      </span>
     </code>
     to handle missing dictionairy keys (EP 16)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#never-unpack-more-than-three-variables-when-functions-return-multiple-values-ep-19">
     #11. Never unpack more than three variables when functions return multiple values (EP #19)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-none-and-docstrings-to-specify-dynamic-default-arguments-ep-24">
     #12. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       None
      </span>
     </code>
     and docstrings to specify dynamic default arguments (EP #24)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comprehensions">
   Comprehensions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-comprehensions-instead-of-map-and-filter-ep-27">
     #13. Use comprehensions instead of
     <code class="docutils literal notranslate">
      <span class="pre">
       map
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       filter
      </span>
     </code>
     (EP #27)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#avoid-more-than-two-control-subexpressions-in-comprehensions-ep-28">
     #14. Avoid more than two control subexpressions in comprehensions (EP #28)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas">
   pandas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#be-aware-of-memory-consumption-and-downcast-where-necessary">
     #15. Be aware of memory consumption and downcast where necessary
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-loc-and-iloc-for-indexing-dataframes-and-forget-about-ix">
     #16. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       .loc
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       .iloc
      </span>
     </code>
     for indexing dataframes (and forget about
     <code class="docutils literal notranslate">
      <span class="pre">
       .ix
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-method-chaining-to-make-your-data-preparation-more-readable">
     #17. Use method chaining to make your data preparation more readable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#don-t-use-inplace-true-operations-on-dataframes">
     #18. Don’t use
     <code class="docutils literal notranslate">
      <span class="pre">
       inplace=True
      </span>
     </code>
     operations on dataframes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-query-and-eval-for-fast-complex-indexing">
     #19. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       .query
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       eval
      </span>
     </code>
     for fast, complex indexing
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Effective Python and idiomatic pandas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-functional-approach-to-python">
     A functional approach to Python
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#structure-of-notebook">
     Structure of notebook
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pythonic-thinking">
   Pythonic thinking
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#follow-the-pep-8-style-guide-ep-2">
     #1. Follow the PEP-8 style guide (EP #2)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#whitespace">
       Whitespace
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naming">
       Naming
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#expressions-and-statements">
       Expressions and Statements
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#imports">
       Imports
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-code-formatters">
       Use code formatters
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-interpolated-f-strings-over-c-style-formatting-ep-4">
     #2. Prefer interpolated f-strings over C-style formatting (EP #4)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-helper-functions-instead-of-complex-expressions-ep-5">
     #3. Write helper functions instead of complex expressions (EP #5)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-multiple-assignment-unpacking-over-indexing-ep-6">
     #4. Prefer multiple assignment unpacking over indexing (EP #6)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-enumerate-over-range-ep-7">
     #5. Prefer
     <code class="docutils literal notranslate">
      <span class="pre">
       enumerate
      </span>
     </code>
     over
     <code class="docutils literal notranslate">
      <span class="pre">
       range
      </span>
     </code>
     (EP #7)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-zip-to-process-iterators-in-parallel-ep-8">
     #6. Use zip to process iterators in parallel (EP #8)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lists-dictionairies-and-dataclasses">
   Lists, dictionairies and dataclasses
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-dataclass-if-you-need-to-create-a-data-container">
     #7. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       dataclass
      </span>
     </code>
     if you need to create a data container
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-catch-all-unpacking-over-slicing-ep-13">
     #8. Prefer catch-all unpacking over slicing (EP #13)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sort-by-complex-criteria-using-the-key-parameter-ep-14">
     #9. Sort by complex criteria using the
     <code class="docutils literal notranslate">
      <span class="pre">
       key
      </span>
     </code>
     parameter (EP #14)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prefer-get-over-in-and-keyerror-to-handle-missing-dictionairy-keys-ep-16">
     #10. Prefer
     <code class="docutils literal notranslate">
      <span class="pre">
       get
      </span>
     </code>
     over
     <code class="docutils literal notranslate">
      <span class="pre">
       in
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       KeyError
      </span>
     </code>
     to handle missing dictionairy keys (EP 16)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#never-unpack-more-than-three-variables-when-functions-return-multiple-values-ep-19">
     #11. Never unpack more than three variables when functions return multiple values (EP #19)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-none-and-docstrings-to-specify-dynamic-default-arguments-ep-24">
     #12. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       None
      </span>
     </code>
     and docstrings to specify dynamic default arguments (EP #24)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comprehensions">
   Comprehensions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-comprehensions-instead-of-map-and-filter-ep-27">
     #13. Use comprehensions instead of
     <code class="docutils literal notranslate">
      <span class="pre">
       map
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       filter
      </span>
     </code>
     (EP #27)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#avoid-more-than-two-control-subexpressions-in-comprehensions-ep-28">
     #14. Avoid more than two control subexpressions in comprehensions (EP #28)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas">
   pandas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#be-aware-of-memory-consumption-and-downcast-where-necessary">
     #15. Be aware of memory consumption and downcast where necessary
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-loc-and-iloc-for-indexing-dataframes-and-forget-about-ix">
     #16. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       .loc
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       .iloc
      </span>
     </code>
     for indexing dataframes (and forget about
     <code class="docutils literal notranslate">
      <span class="pre">
       .ix
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-method-chaining-to-make-your-data-preparation-more-readable">
     #17. Use method chaining to make your data preparation more readable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#don-t-use-inplace-true-operations-on-dataframes">
     #18. Don’t use
     <code class="docutils literal notranslate">
      <span class="pre">
       inplace=True
      </span>
     </code>
     operations on dataframes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-query-and-eval-for-fast-complex-indexing">
     #19. Use
     <code class="docutils literal notranslate">
      <span class="pre">
       .query
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       eval
      </span>
     </code>
     for fast, complex indexing
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><a href="https://colab.research.google.com/github/jads-nl/execute-programming-tutorials/blob/main/execute_programming_lecture.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="tex2jax_ignore mathjax_ignore section" id="effective-python-and-idiomatic-pandas">
<h1>Effective Python and idiomatic pandas<a class="headerlink" href="#effective-python-and-idiomatic-pandas" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-functional-approach-to-python">
<h3>A functional approach to Python<a class="headerlink" href="#a-functional-approach-to-python" title="Permalink to this headline">¶</a></h3>
<p>After you have gained basic working knowledge of Python, it is essential that you continue to develop your skills to write effective Python and use pandas in an idiomatic way. This notebook provides guidelines how to do this. It is very opinionated, and based on a functional programming approach to Python. Functional programming defines a computation using expressions and evaluation—often encapsulated in function definitions. It de-emphasizes or avoids the complexity of state change and mutable objects. This tends to create programs that are more succinct and expressive. Since you can’t easily create purely functional programs in Python, we take a hybrid approach, using functional features where we can add clariy or simplify the code. There are several key features of functional programming that are available in Python which we will use.</p>
<p>Functional programming is often a very good fit for data analysis.</p>
<ul class="simple">
<li><p>Use functions as first-class objects, meaning you can assign functions to variables and pass functions as arguments in other functions allowing for for composability of complex functions for data pipelines using smaller, more simple ones.</p></li>
<li><p>Use of higher-order functions that operate on lists (iterables), like <code class="docutils literal notranslate"><span class="pre">sorted()</span></code>, <code class="docutils literal notranslate"><span class="pre">min()</span></code> and <code class="docutils literal notranslate"><span class="pre">max()</span></code>. NumPy and pandas follow this same principle with so-called <a class="reference external" href="https://numpy.org/doc/stable/reference/ufuncs.html">universal functions</a>, being functions that operate on <code class="docutils literal notranslate"><span class="pre">ndarrays</span></code> in an element-by-element fashion, supporting array broadcasting, type casting, and several other standard features.</p></li>
<li><p>Functional programmes often exploits immutable data structures. Python offers tuples, namedtuples and frozen dataclass as complex but immutable objects. Although NumPy arrays and pandas DataFrames are mutable, we will adhere to the principle of immutable in data pipelines as much as possible.</p></li>
</ul>
</div>
<div class="section" id="structure-of-notebook">
<h3>Structure of notebook<a class="headerlink" href="#structure-of-notebook" title="Permalink to this headline">¶</a></h3>
<p>This notebook is structred in a couple of chapters with a number of related items. Feel free to jump between the items. Each item contains concise and specific guidance explaining how you can write effective, functional Python. We have used the following books and online resources, which are recommended for further reading:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://effectivepython.com/">Effective Python, 2nd edition</a>, by Brett Slatkin (eBook: EUR 30). Referenced as EP for items that have been taken from this book (which is warmly recommended).</p></li>
<li><p>Blog posts on <a class="reference external" href="https://tomaugspurger.github.io/modern-1-intro.html">Modern pandas</a> by Tom Augspurger.</p></li>
<li><p><a class="reference external" href="https://www.packtpub.com/product/functional-python-programming-second-edition/9781788627061">Functional Python Programming</a> by Steven F. Lott (eBook: EUR 5)
-Intermediate tutorials on <a class="reference external" href="https://realpython.com">Real Python</a>.</p></li>
</ul>
</div>
</div>
<div class="section" id="pythonic-thinking">
<h2>Pythonic thinking<a class="headerlink" href="#pythonic-thinking" title="Permalink to this headline">¶</a></h2>
<div class="section" id="follow-the-pep-8-style-guide-ep-2">
<h3>#1. Follow the PEP-8 style guide (EP #2)<a class="headerlink" href="#follow-the-pep-8-style-guide-ep-2" title="Permalink to this headline">¶</a></h3>
<p>Python Enhancement Proposal #8, otherwise known as <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP-8</a>, is the style guide for how to format Python code. You are welcome to write Python code any way you want, as long as it has valid syntax. However, using a consistent style makes your code more approachable and easier to read. Sharing a common style with other Python programmers in the larger community facilitates collaboration on projects. But even if you are the only one who will ever read your code, following the style guide will make it easier for you to change things later, and can help you avoid many common errors.</p>
<p>PEP-8 provides a wealth of details about how to write clear Python code. It continues to be updated as the Python language evolves. It’s worth reading the <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">whole guide online</a>. Here are a few rules you should be sure to follow.</p>
<div class="section" id="whitespace">
<h4>Whitespace<a class="headerlink" href="#whitespace" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Use spaces instead of tabs for indentation.</p></li>
<li><p>Use four spaces for each level of syntactically significant indenting.</p></li>
<li><p>Lines should be 79 characters in length or less.</p></li>
<li><p>Continuations of long expressions onto additional lines should be indented by four extra spaces from their normal indentation level.</p></li>
<li><p>In a file, functions and classes should be separated by two blank lines.</p></li>
<li><p>In a class, methods should be separated by one blank line.</p></li>
<li><p>In a dictionary, put no whitespace between each key and colon, and put a single space before the corresponding value if it fits on the same line.</p></li>
<li><p>Put one—and only one—space before and after the <code class="docutils literal notranslate"><span class="pre">=</span></code> operator in a variable assignment.</p></li>
<li><p>For type annotations, ensure that there is no separation between the variable name and the colon, and use a space before the type information.</p></li>
</ul>
</div>
<div class="section" id="naming">
<h4>Naming<a class="headerlink" href="#naming" title="Permalink to this headline">¶</a></h4>
<p>PEP 8 suggests unique styles of naming for different parts in the language. These conventions make it easy to distinguish which type corresponds to each name when reading code. Follow these guidelines related to naming:</p>
<ul class="simple">
<li><p>Functions, variables, and attributes should be in <code class="docutils literal notranslate"><span class="pre">lowercase_underscore</span></code> format.</p></li>
<li><p>Protected instance attributes should be in <code class="docutils literal notranslate"><span class="pre">_leading_underscore</span></code> format.</p></li>
<li><p>Private instance attributes should be in <code class="docutils literal notranslate"><span class="pre">__double_leading_underscore</span></code> format.</p></li>
<li><p>Classes (including exceptions) should be in <code class="docutils literal notranslate"><span class="pre">CapitalizedWord</span></code> format.</p></li>
<li><p>Module-level constants should be in <code class="docutils literal notranslate"><span class="pre">ALL_CAPS</span></code> format.</p></li>
<li><p>Instance methods in classes should use <code class="docutils literal notranslate"><span class="pre">self</span></code>, which refers to the object, as the name of the first parameter.</p></li>
<li><p>Class methods should use <code class="docutils literal notranslate"><span class="pre">cls</span></code>, which refers to the class, as the name of the first parameter.</p></li>
</ul>
</div>
<div class="section" id="expressions-and-statements">
<h4>Expressions and Statements<a class="headerlink" href="#expressions-and-statements" title="Permalink to this headline">¶</a></h4>
<p>The Zen of Python states: “There should be one—and preferably only one—obvious way to do it.” PEP 8 attempts to codify this style in its guidance for expressions and statements:</p>
<ul class="simple">
<li><p>Use inline negation (<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">a</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">b</span></code>) instead of negation of positive expressions (<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">is</span> <span class="pre">b</span></code>).</p></li>
<li><p>Don’t check for empty containers or sequences (like <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">''</span></code>) by comparing the length to zero (if <code class="docutils literal notranslate"><span class="pre">len(somelist)</span> <span class="pre">==</span> <span class="pre">0</span></code>). Use <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">not</span> <span class="pre">somelist</span></code> and assume that empty values will implicitly evaluate to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>The same thing goes for non-empty containers or sequences (like <code class="docutils literal notranslate"><span class="pre">[1]</span></code> or <code class="docutils literal notranslate"><span class="pre">'hi'</span></code>). The statement <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">somelist</span></code> is implicitly <code class="docutils literal notranslate"><span class="pre">True</span></code> for non-empty values.</p></li>
<li><p>Avoid single-line if statements, <code class="docutils literal notranslate"><span class="pre">for</span></code> and <code class="docutils literal notranslate"><span class="pre">while</span></code> loops, and except compound statements. Spread these over multiple lines for clarity.</p></li>
<li><p>If you can’t fit an expression on one line, surround it with parentheses and add line breaks and indentation to make it easier to read.</p></li>
<li><p>Prefer surrounding multiline expressions with parentheses over using the <code class="docutils literal notranslate"><span class="pre">\</span></code> line continuation character.</p></li>
</ul>
</div>
<div class="section" id="imports">
<h4>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h4>
<p>PEP 8 suggests some guidelines for how to import modules and use them in your code:</p>
<ul>
<li><p>Always put import statements (including from <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">import</span> <span class="pre">y</span></code>) at the top of a file.</p></li>
<li><p>Always use absolute names for modules when importing them, not names relative to the current module’s own path. For example, to import the foo module from within the bar package, you should use from bar import foo, not just import foo.</p></li>
<li><p>If you must do relative imports, use the explicit syntax <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">.</span> <span class="pre">import</span> <span class="pre">foo</span></code>.</p></li>
<li><p>Imports should be in sections in the following order:</p>
<ul class="simple">
<li><p>standard library modules</p></li>
<li><p>third-party modules</p></li>
<li><p>your own modules.</p></li>
</ul>
<p>Each subsection should have imports in alphabetical order.</p>
</li>
</ul>
</div>
<div class="section" id="use-code-formatters">
<h4>Use code formatters<a class="headerlink" href="#use-code-formatters" title="Permalink to this headline">¶</a></h4>
<p>It is recommended to use a code formatter like <a class="reference external" href="https://www.pylint.org">pylint</a> or <a class="reference external" href="https://pypi.org/project/black/">Black</a> to handle these conventions automatically. There is also <a class="reference external" href="https://github.com/drillan/jupyter-black">Jupyter Black</a> for doing this in notebooks.</p>
</div>
</div>
<div class="section" id="prefer-interpolated-f-strings-over-c-style-formatting-ep-4">
<h3>#2. Prefer interpolated f-strings over C-style formatting (EP #4)<a class="headerlink" href="#prefer-interpolated-f-strings-over-c-style-formatting-ep-4" title="Permalink to this headline">¶</a></h3>
<p>Before f-strings were introduced in Python 3.6, you had to do this to format your strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot;Eric&quot;</span>
<span class="n">last_name</span> <span class="o">=</span> <span class="s2">&quot;Idle&quot;</span>
<span class="n">age</span> <span class="o">=</span> <span class="mi">74</span>
<span class="n">profession</span> <span class="o">=</span> <span class="s2">&quot;comedian&quot;</span>
<span class="n">affiliation</span> <span class="o">=</span> <span class="s2">&quot;Monty Python&quot;</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Hello, </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">. You are </span><span class="si">%s</span><span class="s2">. You are a </span><span class="si">%s</span><span class="s2">. You were a member of </span><span class="si">%s</span><span class="s2">.&quot;</span>
    <span class="o">%</span> <span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">profession</span><span class="p">,</span> <span class="n">affiliation</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hello, Eric Idle. You are 74. You are a comedian. You were a member of Monty Python.
</pre></div>
</div>
</div>
</div>
<p>Although the <code class="docutils literal notranslate"><span class="pre">str.format()</span></code> syntax is definitely better, it is still verbose:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Hello </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">, You are a </span><span class="si">{}</span><span class="s2">. You are a</span><span class="si">{}</span><span class="s2">. You were a member of </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">profession</span><span class="p">,</span> <span class="n">affiliation</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hello Eric Idle, You are a 74. You are acomedian. You were a member of Monty Python
</pre></div>
</div>
</div>
</div>
<p>With f-strings this becomes a lot more readable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Hello </span><span class="si">{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">last_name</span><span class="si">}</span><span class="s2">. You are </span><span class="si">{</span><span class="n">age</span><span class="si">}</span><span class="s2">. You are a </span><span class="si">{</span><span class="n">profession</span><span class="si">}</span><span class="s2">. You were a member of </span><span class="si">{</span><span class="n">affiliation</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hello Eric Idle. You are 74. You are a comedian. You were a member of Monty Python
</pre></div>
</div>
</div>
</div>
<p>You can read more about using f-strings in this <a class="reference external" href="https://realpython.com/python-f-strings/">Real Python tutorial</a>.</p>
</div>
<div class="section" id="write-helper-functions-instead-of-complex-expressions-ep-5">
<h3>#3. Write helper functions instead of complex expressions (EP #5)<a class="headerlink" href="#write-helper-functions-instead-of-complex-expressions-ep-5" title="Permalink to this headline">¶</a></h3>
<p>Python’s pithy syntax makes it easy to write single-line expressions that implement a lot of logic. For example, say that I want to decode the query string from a URL. Here, each query string parameter represents an integer value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">parse_qs</span>

<span class="n">my_values</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="s2">&quot;red=5&amp;blue=0&amp;green=&quot;</span><span class="p">,</span> <span class="n">keep_blank_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">my_values</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;red&#39;: [&#39;5&#39;], &#39;blue&#39;: [&#39;0&#39;], &#39;green&#39;: [&#39;&#39;]}
</pre></div>
</div>
</div>
</div>
<p>Some query string parameters may have multiple values, some may have single values, some may be present but have blank values, and some may be missing entirely. Using the <code class="docutils literal notranslate"><span class="pre">get</span></code> (more on that in <a class="reference external" href="#item11">item 11</a>) method on the result dictionary will return different values in each circumstance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Red:     &quot;</span><span class="p">,</span> <span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Green:   &quot;</span><span class="p">,</span> <span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Opacity: &quot;</span><span class="p">,</span> <span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Red:      [&#39;5&#39;]
Green:    [&#39;&#39;]
Opacity:  None
</pre></div>
</div>
</div>
</div>
<p>It’d be nice if a default value of <code class="docutils literal notranslate"><span class="pre">0</span></code> were assigned when a parameter isn’t supplied or is blank. I might choose to do this with Boolean expressions because it feels like this logic doesn’t merit a whole if statement or helper function quite yet.</p>
<p>Python’s syntax makes this choice all too easy. The trick here is that the empty string, the empty list, and zero all evaluate to <code class="docutils literal notranslate"><span class="pre">False</span></code> implicitly. Thus, the expressions below will evaluate to the subexpression after the or operator when the first subexpression is False:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red</span> <span class="o">=</span> <span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span>
<span class="n">green</span> <span class="o">=</span> <span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Red:     </span><span class="si">{</span><span class="n">red</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Green:   </span><span class="si">{</span><span class="n">green</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opacity: </span><span class="si">{</span><span class="n">opacity</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Red:     &#39;5&#39;
Green:   0
Opacity: 0
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">red</span></code> case works because the key is present in the my_values dictionary. The value is a list with one member: the string <code class="docutils literal notranslate"><span class="pre">'5'</span></code>. This string implicitly evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>, so red is assigned to the first part of the or expression.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">green</span></code> case works because the value in the <code class="docutils literal notranslate"><span class="pre">my_values</span></code> dictionary is a list with one member: an empty string. The empty string implicitly evaluates to <code class="docutils literal notranslate"><span class="pre">False</span></code>, causing the or expression to evaluate to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">opacity</span></code> case works because the value in the <code class="docutils literal notranslate"><span class="pre">my_values</span></code> dictionary is missing altogether. The behavior of the get method is to return its second argument if the key doesn’t exist in the dictionary (see <a class="reference external" href="#item11">item 11: “Prefer <code class="docutils literal notranslate"><span class="pre">get</span></code> over <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> to handle missing dictionary keys”</a>). The default value in this case is a list with one member: an empty string. When <code class="docutils literal notranslate"><span class="pre">opacity</span></code> isn’t found in the dictionary, this code does exactly the same thing as the <code class="docutils literal notranslate"><span class="pre">green</span></code> case.</p>
<p>However, this expression is difficult to read, and it still doesn’t do everything I need. I’d also want to ensure that all the parameter values are converted to integers so I can immediately use them in mathematical expressions. To do that, I’d wrap each expression with the int built-in function to parse the string as an integer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">green</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Red:     </span><span class="si">{</span><span class="n">red</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Green:   </span><span class="si">{</span><span class="n">green</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opacity: </span><span class="si">{</span><span class="n">opacity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Red:     5
Green:   0
Opacity: 0
</pre></div>
</div>
</div>
</div>
<p>You see this get unwieldly quite quickly. Furthermore, if you need to reuse this logic repeatedly - even just to or three times, as in this example, - then writing a helper function is the way to go:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_first_int</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">found</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">default</span>


<span class="n">green</span> <span class="o">=</span> <span class="n">get_first_int</span><span class="p">(</span><span class="n">my_values</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Green:   </span><span class="si">{</span><span class="n">green</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Green:   0
</pre></div>
</div>
</div>
</div>
<p>As soon as expressions get complicated, it’s time to consider splitting them into smaller pieces and moving logic into helper functions. What you gain in readability always outweighs what brevity may have afforded you. Avoid letting Python’s pithy syntax for complex expressions from getting you into a mess like this. Follow the <strong>DRY</strong> principle: <em>Don’t repeat yourself</em>.</p>
<p><a id='item4'></a></p>
</div>
<div class="section" id="prefer-multiple-assignment-unpacking-over-indexing-ep-6">
<h3>#4. Prefer multiple assignment unpacking over indexing (EP #6)<a class="headerlink" href="#prefer-multiple-assignment-unpacking-over-indexing-ep-6" title="Permalink to this headline">¶</a></h3>
<p>Python also has syntax for unpacking, which allows for assigning multiple values in a single statement. The patterns that you specify in unpacking assignments look a lot like trying to mutate tuples—which isn’t allowed—but they actually work quite differently. For example, if you know that a tuple is a pair, instead of using indexes to access its values, you can assign it to a tuple of two variable names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Peanut butter&quot;</span><span class="p">,</span> <span class="s2">&quot;Jelly&quot;</span><span class="p">)</span>
<span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">item</span>  <span class="c1"># Unpacking</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Peanut butter and Jelly
</pre></div>
</div>
</div>
</div>
<p>Unpacking has less visual noise than accessing the tuple’s indexes, and it often requires fewer lines. The same pattern matching syntax of unpacking works when assigning to lists, sequences, and multiple levels of arbitrary iterables within iterables. Newcomers to Python may be surprised to learn that unpacking can even be used to swap values in place without the need to create temporary variables. Here, I use typical syntax with indexes to swap the values between two positions in a list as part of an ascending order sorting algorithm (using <a class="reference external" href="https://en.wikipedia.org/wiki/Bubble_sort">bubble sort</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bubble_sort</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>


<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pretzels&quot;</span><span class="p">,</span> <span class="s2">&quot;carrots&quot;</span><span class="p">,</span> <span class="s2">&quot;arugula&quot;</span><span class="p">,</span> <span class="s2">&quot;bacon&quot;</span><span class="p">]</span>
<span class="n">bubble_sort</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;arugula&#39;, &#39;bacon&#39;, &#39;carrots&#39;, &#39;pretzels&#39;]
</pre></div>
</div>
</div>
</div>
<p>However, with unpacking syntax, it’s possible to swap indexes in a single line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bubble_sort</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Swap</span>


<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pretzels&quot;</span><span class="p">,</span> <span class="s2">&quot;carrots&quot;</span><span class="p">,</span> <span class="s2">&quot;arugula&quot;</span><span class="p">,</span> <span class="s2">&quot;bacon&quot;</span><span class="p">]</span>
<span class="n">bubble_sort</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;arugula&#39;, &#39;bacon&#39;, &#39;carrots&#39;, &#39;pretzels&#39;]
</pre></div>
</div>
</div>
</div>
<p>The way this swap works is that the right side of the assignment (<code class="docutils literal notranslate"><span class="pre">a[i],</span> <span class="pre">a[i-1]</span></code>) is evaluated first, and its values are put into a new temporary, unnamed tuple (such as <code class="docutils literal notranslate"><span class="pre">('carrots',</span> <span class="pre">'pretzels')</span></code> on the first iteration of the loops). Then, the unpacking pattern from the left side of the assignment (<code class="docutils literal notranslate"><span class="pre">a[i-1],</span> <span class="pre">a[i]</span></code>) is used to receive that tuple value and assign it to the variable names <code class="docutils literal notranslate"><span class="pre">a[i-1]</span></code> and <code class="docutils literal notranslate"><span class="pre">a[i]</span></code>, respectively. This replaces <code class="docutils literal notranslate"><span class="pre">'pretzels'</span></code> with <code class="docutils literal notranslate"><span class="pre">'carrots'</span></code> at index <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">'carrots'</span></code> with <code class="docutils literal notranslate"><span class="pre">'pretzels'</span></code> at index 1. Finally, the temporary unnamed tuple silently goes away.</p>
<p>Another valuable application of unpacking is in the target list of for loops and similar constructs, such as comprehensions and generator expressions (see <a class="reference external" href="#item13">item 13: “Use comprehensions instead of <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">filter</span></code>”</a> for those). As an example for contrast, here I iterate over a list of snacks without using unpacking:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">snacks</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;bacon&quot;</span><span class="p">,</span> <span class="mi">350</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;donut&quot;</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;muffin&quot;</span><span class="p">,</span> <span class="mi">190</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snacks</span><span class="p">)):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">snacks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">calories</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">calories</span><span class="si">}</span><span class="s2"> calories&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>#1: bacon has 350 calories
#2: donut has 240 calories
#3: muffin has 190 calories
</pre></div>
</div>
</div>
</div>
<p>This works, but it’s noisy. There are a lot of extra characters required in order to index into the various levels of the snacks structure. Here, I achieve the same output by using unpacking along with the enumerate built-in function (see <a class="reference external" href="#item5">item 5: “Prefer enumerate Over range”</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">calories</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">snacks</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">calories</span><span class="si">}</span><span class="s2"> calories&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>#1: bacon has 350 calories
#2: donut has 240 calories
#3: muffin has 190 calories
</pre></div>
</div>
</div>
</div>
<p>Using unpacking wisely will enable you to avoid indexing when possible, resulting in clearer and more Pythonic code. So remember:</p>
<ul class="simple">
<li><p>Python has special syntax called unpacking for assigning multiple values in a single statement.</p></li>
<li><p>Unpacking is generalized in Python and can be applied to any iterable, including many levels of iterables within iterables.</p></li>
<li><p>Reduce visual noise and increase code clarity by using unpacking to avoid explicitly indexing into sequences.</p></li>
</ul>
<p><a id='item5'></a></p>
</div>
<div class="section" id="prefer-enumerate-over-range-ep-7">
<h3>#5. Prefer <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> over <code class="docutils literal notranslate"><span class="pre">range</span></code> (EP #7)<a class="headerlink" href="#prefer-enumerate-over-range-ep-7" title="Permalink to this headline">¶</a></h3>
<p>When you have a data structure to iterate over, like a list of strings, you can loop directly over the sequence:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flavor_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vanilla&quot;</span><span class="p">,</span> <span class="s2">&quot;chocolate&quot;</span><span class="p">,</span> <span class="s2">&quot;pecan&quot;</span><span class="p">,</span> <span class="s2">&quot;strawberry&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">flavor</span> <span class="ow">in</span> <span class="n">flavor_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">flavor</span><span class="si">}</span><span class="s2"> is delicious&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vanilla is delicious
chocolate is delicious
pecan is delicious
strawberry is delicious
</pre></div>
</div>
</div>
</div>
<p>Often, you’ll want to iterate over a list and also know the index of the current item in the list. For example, say that I want to print the ranking of my favorite ice cream flavors. One way to do it is by using range:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flavor_list</span><span class="p">)):</span>
    <span class="n">flavor</span> <span class="o">=</span> <span class="n">flavor_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">flavor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1: vanilla
2: chocolate
3: pecan
4: strawberry
</pre></div>
</div>
</div>
</div>
<p>This looks clumsy compared with the other example of iterating over <code class="docutils literal notranslate"><span class="pre">flavor_list</span></code>. I have to get the length of the list. I have to index into the array. The multiple steps make it harder to read.</p>
<p>Python provides the <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> built-in function to address this situation. <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> wraps any iterator with a lazy generator (read <a class="reference external" href="https://realpython.com/introduction-to-python-generators/">more on generators in this Real Python article</a>). <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> yields pairs of the loop index and the next value from the given iterator. Here, I manually advance the returned iterator with the next built-in function to demonstrate what it does:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">flavor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flavor_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">flavor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1: vanilla
2: chocolate
3: pecan
4: strawberry
</pre></div>
</div>
</div>
</div>
<p>I can make this even shorter by specifying the number from which <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> should begin counting (<code class="docutils literal notranslate"><span class="pre">1</span></code> in this case) as the second parameter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">flavor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flavor_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">flavor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1: vanilla
2: chocolate
3: pecan
4: strawberry
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-zip-to-process-iterators-in-parallel-ep-8">
<h3>#6. Use zip to process iterators in parallel (EP #8)<a class="headerlink" href="#use-zip-to-process-iterators-in-parallel-ep-8" title="Permalink to this headline">¶</a></h3>
<p>Often in Python you find yourself with many lists of related objects. List comprehensions make it easy to take a source list and get a derived list by applying an expression (see <a class="reference external" href="#item13">item 13: “Use comprehensions instead of <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">filter</span></code>”</a>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Cecilia&quot;</span><span class="p">,</span> <span class="s2">&quot;Lise&quot;</span><span class="p">,</span> <span class="s2">&quot;Marie&quot;</span><span class="p">]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[7, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>The items in the derived list are related to the items in the source list by their indexes. To iterate over both lists in parallel, I can iterate over the length of the <code class="docutils literal notranslate"><span class="pre">names</span></code> source list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longest_name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">max_count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">max_count</span><span class="p">:</span>
        <span class="n">longest_name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">max_count</span> <span class="o">=</span> <span class="n">count</span>

<span class="nb">print</span><span class="p">(</span><span class="n">longest_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cecilia
</pre></div>
</div>
</div>
</div>
<p>The problem is that this whole loop statement is visually noisy. The indexes into <code class="docutils literal notranslate"><span class="pre">names</span></code> and <code class="docutils literal notranslate"><span class="pre">counts</span></code> make the code hard to read. Indexing into the arrays by the loop index <code class="docutils literal notranslate"><span class="pre">i</span></code> happens twice. Using <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> (see <a class="reference external" href="#item5">item 5: “Prefer enumerate Over range”</a>) improves this slightly, but it’s still not ideal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longest_name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">max_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">max_count</span><span class="p">:</span>
        <span class="n">longest_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">max_count</span> <span class="o">=</span> <span class="n">count</span>

<span class="nb">print</span><span class="p">(</span><span class="n">longest_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cecilia
</pre></div>
</div>
</div>
</div>
<p>To make this code clearer, Python provides the <code class="docutils literal notranslate"><span class="pre">zip</span></code> built-in function. <code class="docutils literal notranslate"><span class="pre">zip</span></code> wraps two or more iterators with a lazy generator. The <code class="docutils literal notranslate"><span class="pre">zip</span></code> generator yields tuples containing the next value from each iterator. These tuples can be unpacked directly within a for statement (see <a class="reference external" href="#item4">item 4: “Prefer multiple assignment unpacking over indexing”</a>). The resulting code is much cleaner than the code for indexing into multiple lists:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longest_name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">max_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">counts</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">max_count</span><span class="p">:</span>
        <span class="n">longest_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">max_count</span> <span class="o">=</span> <span class="n">count</span>

<span class="nb">print</span><span class="p">(</span><span class="n">longest_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cecilia
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">zip</span></code> consumes the iterators it wraps one item at a time, which means it can be used with infinitely long inputs without risk of a program using too much memory and crashing.</p>
<p>However, beware of <code class="docutils literal notranslate"><span class="pre">zip</span></code>’s behavior when the input iterators are of different lengths. For example, say that I add another item to names above but forget to update counts. Running zip on the two input lists will have an unexpected result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Rosalind&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">counts</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cecilia
Lise
Marie
</pre></div>
</div>
</div>
</div>
<p>The new item for <code class="docutils literal notranslate"><span class="pre">'Rosalind'</span></code> isn’t there. Why not? This is just how <code class="docutils literal notranslate"><span class="pre">zip</span></code> works. It keeps yielding tuples until any one of the wrapped iterators is exhausted. Its output is as long as its shortest input. This approach works fine when you know that the iterators are of the same length, which is often the case for derived lists created by list comprehensions. But in many other cases, the truncating behavior of <code class="docutils literal notranslate"><span class="pre">zip</span></code> is surprising and bad. If you don’t expect the lengths of the lists passed to zip to be equal, consider using the <code class="docutils literal notranslate"><span class="pre">zip_longest</span></code> function from the <code class="docutils literal notranslate"><span class="pre">itertools</span></code> built-in module instead:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">counts</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cecilia: 7
Lise: 4
Marie: 5
Rosalind: None
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">zip_longest</span></code> replaces missing values—the length of the string <code class="docutils literal notranslate"><span class="pre">'Rosalind'</span></code> in this case—with whatever fillvalue is passed to it, which defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">itertools</span></code> implements more iterator building block that come from functional programming. Read more in <a class="reference external" href="https://realpython.com/python-itertools/">this Real Python article</a>.</p>
</div>
</div>
<div class="section" id="lists-dictionairies-and-dataclasses">
<h2>Lists, dictionairies and dataclasses<a class="headerlink" href="#lists-dictionairies-and-dataclasses" title="Permalink to this headline">¶</a></h2>
<div class="section" id="use-dataclass-if-you-need-to-create-a-data-container">
<h3>#7. Use <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> if you need to create a data container<a class="headerlink" href="#use-dataclass-if-you-need-to-create-a-data-container" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> class was introduced in Python 3.7. Given our functional approach, you should first ask yourself whether you really need a new container object for your data. In the words of <a class="reference external" href="https://en.wikipedia.org/wiki/Alan_Perlis">Alan J. Perlis</a>:</p>
<blockquote>
<div><p>It is better to have 100 functions operate on one data structure than to have 10 functions operate on 10 data structures.</p>
</div></blockquote>
<p>If you have consciously decided you <em>do</em> want a new data object, then <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> is your friend. It is created using the new <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> decorator as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">DataClassCard</span><span class="p">:</span>
    <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">suit</span><span class="p">:</span> <span class="nb">str</span>
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> comes with basic functionality already implemented. For instance, you can instantiate, print, and compare <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> instances straight out of the box:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">queen_of_hearts</span> <span class="o">=</span> <span class="n">DataClassCard</span><span class="p">(</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;Hearts&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">queen_of_hearts</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">queen_of_hearts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DataClassCard(rank=&#39;Q&#39;, suit=&#39;Hearts&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">queen_of_hearts</span> <span class="o">==</span> <span class="n">DataClassCard</span><span class="p">(</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;Hearts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Read more on <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> and how to use them in <a class="reference external" href="https://realpython.com/python-data-classes/">this Real Python tutorial</a></p>
</div>
<div class="section" id="prefer-catch-all-unpacking-over-slicing-ep-13">
<h3>#8. Prefer catch-all unpacking over slicing (EP #13)<a class="headerlink" href="#prefer-catch-all-unpacking-over-slicing-ep-13" title="Permalink to this headline">¶</a></h3>
<p>One limitation of basic unpacking (see <a class="reference external" href="#item4">item 4</a>) is that you must know the length of the sequences you’re unpacking in advance. For example, here I have a list of the ages of cars that are being traded in at a dealership. When I try to take the first two items of the list with basic unpacking, an exception is raised at runtime:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_ages</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="n">car_ages_descending</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">car_ages</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">oldest</span><span class="p">,</span> <span class="n">second_oldest</span> <span class="o">=</span> <span class="n">car_ages_descending</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_3536</span><span class="o">/</span><span class="mf">2451885761.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">car_ages</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">car_ages_descending</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">car_ages</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">oldest</span><span class="p">,</span> <span class="n">second_oldest</span> <span class="o">=</span> <span class="n">car_ages_descending</span>

<span class="ne">ValueError</span>: too many values to unpack (expected 2)
</pre></div>
</div>
</div>
</div>
<p>Newcomers to Python often rely on indexing and slicing for this situation. For example, here I extract the oldest, second oldest, and other car ages from a list of at least two items:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oldest</span> <span class="o">=</span> <span class="n">car_ages_descending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">second_oldest</span> <span class="o">=</span> <span class="n">car_ages_descending</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">others</span> <span class="o">=</span> <span class="n">car_ages_descending</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oldest</span><span class="p">,</span> <span class="n">second_oldest</span><span class="p">,</span> <span class="n">others</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19 [15, 9, 8, 7, 6, 4, 1, 0]
</pre></div>
</div>
</div>
</div>
<p>However, to unpack assignments that contain a starred expression, you must have at least one required part, or else you’ll get a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code>. You can’t use a catch-all expression on its own:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">others</span> <span class="o">=</span> <span class="n">car_ages_descending</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;/tmp/ipykernel_3536/2422727027.py&quot;</span><span class="gt">, line </span><span class="mi">1</span>
    <span class="o">*</span><span class="n">others</span> <span class="o">=</span> <span class="n">car_ages_descending</span>
    <span class="o">^</span>
<span class="ne">SyntaxError</span>: starred assignment target must be in a list or tuple
</pre></div>
</div>
</div>
</div>
<p>You also can’t use multiple catch-all expressions in a single-level unpacking pattern:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">middle</span><span class="p">,</span> <span class="o">*</span><span class="n">second_middle</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;/tmp/ipykernel_3536/1187532336.py&quot;</span><span class="gt">, line </span><span class="mi">1</span>
    <span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">middle</span><span class="p">,</span> <span class="o">*</span><span class="n">second_middle</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="o">^</span>
<span class="ne">SyntaxError</span>: two starred expressions in assignment
</pre></div>
</div>
</div>
</div>
<p>But it is possible to use multiple starred expressions in an unpacking assignment statement, as long as they’re catch-alls for different parts of the multilevel structure being unpacked. I don’t recommend doing the following (see <a class="reference external" href="#item11">item 11: “Never unpack more than three variables when functions return multiple values”</a> for related guidance), but understanding it should help you develop an intuition for how starred expressions can be used in unpacking assignments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_inventory</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Downtown&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Silver Shadow&quot;</span><span class="p">,</span> <span class="s2">&quot;Pinto&quot;</span><span class="p">,</span> <span class="s2">&quot;DMC&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Airport&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Skyline&quot;</span><span class="p">,</span> <span class="s2">&quot;Viper&quot;</span><span class="p">,</span> <span class="s2">&quot;Gremlin&quot;</span><span class="p">,</span> <span class="s2">&quot;Nova&quot;</span><span class="p">),</span>
<span class="p">}</span>

<span class="p">((</span><span class="n">loc1</span><span class="p">,</span> <span class="p">(</span><span class="n">best1</span><span class="p">,</span> <span class="o">*</span><span class="n">rest1</span><span class="p">)),</span> <span class="p">(</span><span class="n">loc2</span><span class="p">,</span> <span class="p">(</span><span class="n">best2</span><span class="p">,</span> <span class="o">*</span><span class="n">rest2</span><span class="p">)))</span> <span class="o">=</span> <span class="n">car_inventory</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best at </span><span class="si">{</span><span class="n">loc1</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">best1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rest1</span><span class="p">)</span><span class="si">}</span><span class="s2"> others&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best at </span><span class="si">{</span><span class="n">loc2</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">best2</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rest2</span><span class="p">)</span><span class="si">}</span><span class="s2"> others&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best at Downtown is Silver Shadow, 2 others
Best at Airport is Skyline, 3 others
</pre></div>
</div>
</div>
</div>
<p>Starred expressions become list instances in all cases. If there are no leftover items from the sequence being unpacked, the catch-all part will be an empty <code class="docutils literal notranslate"><span class="pre">list</span></code>. This is especially useful when you’re processing a sequence that you know in advance has at least <span class="math notranslate nohighlight">\(N\)</span> elements:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">short_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">short_list</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 2 []
</pre></div>
</div>
</div>
</div>
<p>But with the addition of starred expressions, the value of unpacking iterators becomes clear. For example, here I have a generator that yields the rows of a CSV file containing all car orders from the dealership this week:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_csv</span><span class="p">():</span>
    <span class="k">yield</span> <span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="s2">&quot;Make&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Price&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">yield</span> <span class="p">(</span><span class="s2">&quot;2019-03-25&quot;</span><span class="p">,</span> <span class="s2">&quot;Honda&quot;</span><span class="p">,</span> <span class="s2">&quot;Fit&quot;</span><span class="p">,</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span> <span class="s2">&quot;$3400&quot;</span><span class="p">)</span>
        <span class="k">yield</span> <span class="p">(</span><span class="s2">&quot;2019-03-26&quot;</span><span class="p">,</span> <span class="s2">&quot;Ford&quot;</span><span class="p">,</span> <span class="s2">&quot;F150&quot;</span><span class="p">,</span> <span class="s2">&quot;2008&quot;</span><span class="p">,</span> <span class="s2">&quot;$2400&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Processing the results of this generator using indexes and slices is fine, but it requires multiple lines and is visually noisy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_csv_rows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">generate_csv</span><span class="p">())</span>
<span class="n">header</span> <span class="o">=</span> <span class="n">all_csv_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">all_csv_rows</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CSV Header:&quot;</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row count: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CSV Header: (&#39;Date&#39;, &#39;Make&#39;, &#39;Model&#39;, &#39;Year&#39;, &#39;Price&#39;)
Row count:  200
</pre></div>
</div>
</div>
</div>
<p>Unpacking with a starred expression makes it easy to process the first row—the header—separately from the rest of the iterator’s contents. This is much clearer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">generate_csv</span><span class="p">()</span>
<span class="n">header</span><span class="p">,</span> <span class="o">*</span><span class="n">rows</span> <span class="o">=</span> <span class="n">it</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CSV Header:&quot;</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row count: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CSV Header: (&#39;Date&#39;, &#39;Make&#39;, &#39;Model&#39;, &#39;Year&#39;, &#39;Price&#39;)
Row count:  200
</pre></div>
</div>
</div>
</div>
<p>Keep in mind, however, that because a starred expression is always turned into a list, unpacking an iterator also risks the potential of using up all of the memory on your computer and causing your program to crash. So you should only use catch-all unpacking on iterators when you have good reason to believe that the result data will all fit in memory.</p>
<p>Finally, note that the unpacking operators <code class="docutils literal notranslate"><span class="pre">*</span></code> for <code class="docutils literal notranslate"><span class="pre">list</span></code>s and <code class="docutils literal notranslate"><span class="pre">**</span></code> for <code class="docutils literal notranslate"><span class="pre">dict</span></code>s is often used in functions. Read <a class="reference external" href="https://realpython.com/python-kwargs-and-args/">this tutorial on Real Python that demystifies <code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></a>. Note that <code class="docutils literal notranslate"><span class="pre">args</span></code> and <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> are just names that are used by convention to refer to positional arguments and keyword arguments, respectively. You could use any other name if you wanted to. The magic lies in the <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">**</span></code> unpacking operators, as is shown with this trick from Real Python’s homepage:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="n">z</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">y</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>When unpacking <code class="docutils literal notranslate"><span class="pre">dict</span></code>s with overlapping keys, the last value is kept:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="p">{</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">y</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 1, &#39;b&#39;: 3, &#39;c&#39;: 4}
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> you can easily re-use parameters are the same for different calls to the same function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">csv_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sep&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">}</span>
<span class="n">ames</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/jads-nl/discover-projects/blob/main/ames-housing/AmesHousing.csv?raw=true&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">csv_kwargs</span>
<span class="p">)</span>
<span class="n">pima</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/jads-nl/discover-projects/blob/main/pima-indians-diabetes/diabetes.csv?raw=true&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">csv_kwargs</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sort-by-complex-criteria-using-the-key-parameter-ep-14">
<h3>#9. Sort by complex criteria using the <code class="docutils literal notranslate"><span class="pre">key</span></code> parameter (EP #14)<a class="headerlink" href="#sort-by-complex-criteria-using-the-key-parameter-ep-14" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">list</span></code> built-in type provides a sort method for ordering the items in a <code class="docutils literal notranslate"><span class="pre">list</span></code> instance based on a variety of criteria. By default, sort will order a list’s contents by the natural ascending order of the items. For example, here I sort a list of integers from smallest to largest:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">93</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11, 68, 70, 86, 93]
</pre></div>
</div>
</div>
</div>
<p>The sort method works for nearly all built-in types (strings, floats, etc.) that have a natural ordering to them. What does <code class="docutils literal notranslate"><span class="pre">sort</span></code> do with objects? Often there’s an attribute on the object that you’d like to use for sorting. To support this use case, the <code class="docutils literal notranslate"><span class="pre">sort</span></code> method accepts a key parameter that’s expected to be a function. The key function is passed a single argument, which is an item from the list that is being sorted. The return value of the key function should be a comparable value (i.e., with a natural ordering) to use in place of an item for sorting purposes.</p>
<p>For example, here I define a <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> to represent various tools. To sort a the <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">Tool</span></code> object alphabetically by name, I use the lambda keyword to define a function for the key parameter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Tool</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span>


<span class="n">tools</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;hammer&quot;</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;screwdriver&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;chisel&quot;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Unsorted:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span>
<span class="n">tools</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sorted:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unsorted:
 [Tool(name=&#39;level&#39;, weight=3.5), Tool(name=&#39;hammer&#39;, weight=1.25), Tool(name=&#39;screwdriver&#39;, weight=0.5), Tool(name=&#39;chisel&#39;, weight=0.25)]

Sorted:
 [Tool(name=&#39;chisel&#39;, weight=0.25), Tool(name=&#39;hammer&#39;, weight=1.25), Tool(name=&#39;level&#39;, weight=3.5), Tool(name=&#39;screwdriver&#39;, weight=0.5)]
</pre></div>
</div>
</div>
</div>
<p>I can just as easily define another lambda function to sort by weight and pass it as the key parameter to the sort method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tools</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">By weight:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>By weight:
 [Tool(name=&#39;chisel&#39;, weight=0.25), Tool(name=&#39;screwdriver&#39;, weight=0.5), Tool(name=&#39;hammer&#39;, weight=1.25), Tool(name=&#39;level&#39;, weight=3.5)]
</pre></div>
</div>
</div>
</div>
<p>Within the lambda function passed as the key parameter you can access attributes of items as I’ve done here, index into items (for sequences, tuples, and dictionaries), or use any other valid expression.</p>
<p>For basic types like strings, you may even want to use the key function to do transformations on the values before sorting. For example, here I apply the <code class="docutils literal notranslate"><span class="pre">lower</span></code> method to each item in a <code class="docutils literal notranslate"><span class="pre">list</span></code> of place names to ensure that they’re in alphabetical order, ignoring any capitalization (since in the natural lexical ordering of strings, capital letters come before lowercase letters):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">places</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">,</span> <span class="s2">&quot;work&quot;</span><span class="p">,</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;Paris&quot;</span><span class="p">]</span>
<span class="n">places</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Case sensitive: &quot;</span><span class="p">,</span> <span class="n">places</span><span class="p">)</span>
<span class="n">places</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Case insensitive:&quot;</span><span class="p">,</span> <span class="n">places</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Case sensitive:  [&#39;New York&#39;, &#39;Paris&#39;, &#39;home&#39;, &#39;work&#39;]
Case insensitive: [&#39;home&#39;, &#39;New York&#39;, &#39;Paris&#39;, &#39;work&#39;]
</pre></div>
</div>
</div>
</div>
<p>Sometimes you may need to use multiple criteria for sorting. For example, say that I have a list of power tools and I want to sort them first by weight and then by name. How can I accomplish this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_tools</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;drill&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;circular saw&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;jackhammer&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
    <span class="n">Tool</span><span class="p">(</span><span class="s2">&quot;sander&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The simplest solution in Python is to use the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> type. Tuples are immutable sequences of arbitrary Python values. Tuples are comparable by default and have a natural ordering, meaning that they implement all of the special methods, such as <code class="docutils literal notranslate"><span class="pre">__lt__</span></code>, that are required by the <code class="docutils literal notranslate"><span class="pre">sort</span></code> method. Tuples implement these special method comparators by iterating over each position in the tuple and comparing the corresponding values one index at a time. Here, I show how this works when one tool is heavier than another:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saw</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;circular saw&quot;</span><span class="p">)</span>
<span class="n">jackhammer</span> <span class="o">=</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;jackhammer&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">jackhammer</span> <span class="o">&lt;</span> <span class="n">saw</span><span class="p">)</span>  <span class="c1"># False</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>If the first position in the tuples being compared are equal—weight in this case—then the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> comparison will move on to the second position, and so on. You can take advantage of this <code class="docutils literal notranslate"><span class="pre">tupl</span></code>e comparison behavior in order to sort the <code class="docutils literal notranslate"><span class="pre">list</span></code> of power tools first by weight and then by name. Here, I define a <code class="docutils literal notranslate"><span class="pre">key</span></code> function that returns a tuple containing the two attributes that I want to sort on in order of priority:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_tools</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">power_tools</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Tool(name=&#39;drill&#39;, weight=4), Tool(name=&#39;sander&#39;, weight=4), Tool(name=&#39;circular saw&#39;, weight=5), Tool(name=&#39;jackhammer&#39;, weight=40)]
</pre></div>
</div>
</div>
</div>
<p>One limitation of having the <code class="docutils literal notranslate"><span class="pre">key</span></code> function return a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> is that the direction of sorting for all criteria must be the same (either all in ascending order, or all in descending order). If I provide the <code class="docutils literal notranslate"><span class="pre">reverse</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">sort</span></code> method, it will affect both criteria in the <code class="docutils literal notranslate"><span class="pre">tuple</span></code> the same way (note how ‘<code class="docutils literal notranslate"><span class="pre">sander'</span></code> now comes before <code class="docutils literal notranslate"><span class="pre">'drill'</span></code> instead of after):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_tools</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>  <span class="c1"># Makes all criteria descending</span>
<span class="nb">print</span><span class="p">(</span><span class="n">power_tools</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Tool(name=&#39;jackhammer&#39;, weight=40), Tool(name=&#39;circular saw&#39;, weight=5), Tool(name=&#39;sander&#39;, weight=4), Tool(name=&#39;drill&#39;, weight=4)]
</pre></div>
</div>
</div>
</div>
<p>For situations where you do want to have different sorting orders, Python provides a <em>stable</em> sorting algorithm. The <code class="docutils literal notranslate"><span class="pre">sort</span></code> method of the list type will preserve the order of the input list when the <code class="docutils literal notranslate"><span class="pre">key</span></code> function returns values that are equal to each other. This means that I can call <code class="docutils literal notranslate"><span class="pre">sort</span></code> multiple times on the same <code class="docutils literal notranslate"><span class="pre">list</span></code> to combine different criteria together. Here, I produce the same sort ordering of <code class="docutils literal notranslate"><span class="pre">weight</span></code> descending and <code class="docutils literal notranslate"><span class="pre">name</span></code>b ascending as I did above but by using two separate calls to sort:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_tools</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># Name ascending</span>
<span class="n">power_tools</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Weight descending</span>
<span class="nb">print</span><span class="p">(</span><span class="n">power_tools</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Tool(name=&#39;jackhammer&#39;, weight=40), Tool(name=&#39;circular saw&#39;, weight=5), Tool(name=&#39;drill&#39;, weight=4), Tool(name=&#39;sander&#39;, weight=4)]
</pre></div>
</div>
</div>
</div>
<p>This same approach can be used to combine as many different types of sorting criteria as you’d like in any direction, respectively. You just need to make sure that you execute the sorts in the opposite sequence of what you want the final <code class="docutils literal notranslate"><span class="pre">list</span></code> to contain. In this example, I wanted the sort order to be by <code class="docutils literal notranslate"><span class="pre">weight</span></code> descending and then by <code class="docutils literal notranslate"><span class="pre">name</span></code> ascending, so I had to do the <code class="docutils literal notranslate"><span class="pre">name</span></code> sort first, followed by the <code class="docutils literal notranslate"><span class="pre">weight</span></code> sort.</p>
<p>That said, the approach of having the key function return a tuple, and using unary negation to mix sort orders for numbers, is simpler to read and requires less code. I recommend only using multiple calls to sort if it’s absolutely necessary.</p>
<p><a id='item10'></a></p>
</div>
<div class="section" id="prefer-get-over-in-and-keyerror-to-handle-missing-dictionairy-keys-ep-16">
<h3>#10. Prefer <code class="docutils literal notranslate"><span class="pre">get</span></code> over <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> to handle missing dictionairy keys (EP 16)<a class="headerlink" href="#prefer-get-over-in-and-keyerror-to-handle-missing-dictionairy-keys-ep-16" title="Permalink to this headline">¶</a></h3>
<p>The three fundamental operations for interacting with dictionaries are accessing, assigning, and deleting keys and their associated values. The contents of dictionaries are dynamic, and thus it’s entirely possible—even likely—that when you try to access or delete a key, it won’t already be present.</p>
<p>For example, say that I’m trying to determine people’s favorite type of bread to devise the menu for a sandwich shop. Here, I define a dictionary of counters with the current votes for each style:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;pumpernickel&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;sourdough&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>To increment the counter for a new vote, I need to see if the key exists, insert the key with a default counter value of zero if it’s missing, and then increment the counter’s value. This requires accessing the key two times and assigning it once. Here, I accomplish this task using an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement with an <code class="docutils literal notranslate"><span class="pre">in</span></code> expression that returns <code class="docutils literal notranslate"><span class="pre">True</span></code> when the key is present:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;wheat&quot;</span>

<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">counters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">counters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Another way to accomplish the same behavior is by relying on how dictionaries raise a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> exception when you try to get the value for a key that doesn’t exist. This approach is more efficient because it requires only one access and one assignment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">counters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">counters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>This flow of fetching a key that exists or returning a default value is so common that the dict built-in type provides the <code class="docutils literal notranslate"><span class="pre">get</span></code> method to accomplish this task. The second parameter to <code class="docutils literal notranslate"><span class="pre">get</span></code> is the default value to return in the case that the key—the first parameter—isn’t present. This also requires only one access and one assignment, but it’s much shorter than the <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="n">counters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">counters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Thus, for a dictionary with simple types, using the <code class="docutils literal notranslate"><span class="pre">get</span></code> method is the shortest and clearest option.</p>
<blockquote>
<div><p>Note: ff you’re maintaining dictionaries of counters like this, it’s worth considering the Counter class from the collections built-in module, which provides most of the facilities you are likely to need.</p>
</div></blockquote>
<p>What if the values of the dictionary are a more complex type, like a <code class="docutils literal notranslate"><span class="pre">list</span></code>? For example, say that instead of only counting votes, I also want to know who voted for each type of bread. Here, I do this by associating a list of names with each key:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;baguette&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">],</span>
    <span class="s2">&quot;ciabatta&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Coco&quot;</span><span class="p">,</span> <span class="s2">&quot;Deb&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;brioche&quot;</span>
<span class="n">who</span> <span class="o">=</span> <span class="s2">&quot;Elmer&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Similarly, you can use the get method to fetch a list value when the key is present, or do one fetch and one assignment if the key isn’t present:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">votes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">who</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;baguette&#39;: [&#39;Bob&#39;, &#39;Alice&#39;], &#39;ciabatta&#39;: [&#39;Coco&#39;, &#39;Deb&#39;], &#39;brioche&#39;: [&#39;Elmer&#39;]}
</pre></div>
</div>
</div>
</div>
<p>The approach that involves using <code class="docutils literal notranslate"><span class="pre">get</span></code> to fetch list values can further be shortened by one line if you use an assignment expression with the walrus operator which was introduced in Python 3.8. <a class="reference external" href="https://realpython.com/python38-new-features/#the-walrus-in-the-room-assignment-expressions">Read more about that on Real Python</a>. For now, we will just leave you with the example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note: this will throw error on Google Colab, which is Python 3.6</span>
<span class="k">if</span> <span class="p">(</span><span class="n">names</span> <span class="o">:=</span> <span class="n">votes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">votes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">who</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">votes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;baguette&#39;: [&#39;Bob&#39;, &#39;Alice&#39;], &#39;ciabatta&#39;: [&#39;Coco&#39;, &#39;Deb&#39;], &#39;brioche&#39;: [&#39;Elmer&#39;, &#39;Elmer&#39;]}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p><a id='item11'></a></p>
<div class="section" id="never-unpack-more-than-three-variables-when-functions-return-multiple-values-ep-19">
<h3>#11. Never unpack more than three variables when functions return multiple values (EP #19)<a class="headerlink" href="#never-unpack-more-than-three-variables-when-functions-return-multiple-values-ep-19" title="Permalink to this headline">¶</a></h3>
<p>One effect of the unpacking syntax (see <a class="reference external" href="#item4">item 4</a>) is that it allows Python functions to seemingly return more than one value. For example, say that I’m trying to determine various statistics for a population of alligators. Given a list of lengths, I need to calculate the minimum and maximum lengths in the population. Here, I do this in a single function that appears to return two values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_stats</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">minimum</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">maximum</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span>


<span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">63</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>  <span class="c1"># Two return values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min: </span><span class="si">{</span><span class="n">minimum</span><span class="si">}</span><span class="s2">, Max: </span><span class="si">{</span><span class="n">maximum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Min: 60, Max: 73
</pre></div>
</div>
</div>
</div>
<p>The way this works is that multiple values are returned together in a two-item tuple. The calling code then unpacks the returned tuple by assigning two variables. Here, I use an even simpler example to show how an unpacking statement and multiple-return function work the same way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">assert</span> <span class="n">first</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="n">second</span> <span class="o">==</span> <span class="mi">2</span>


<span class="k">def</span> <span class="nf">my_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>


<span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">my_function</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">first</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="n">second</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">my_function</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Multiple return values can also be received by starred expressions for catch-all unpacking. For example, say I need another function that calculates how big each alligator is relative to the population average. This function returns a list of ratios, but I can receive the longest and shortest items individually by using a starred expression for the middle portion of the list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_avg_ratio</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="n">average</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">]</span>
    <span class="n">scaled</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scaled</span>


<span class="n">longest</span><span class="p">,</span> <span class="o">*</span><span class="n">middle</span><span class="p">,</span> <span class="n">shortest</span> <span class="o">=</span> <span class="n">get_avg_ratio</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Longest: </span><span class="si">{</span><span class="n">longest</span><span class="si">:</span><span class="s2">&gt;4.0%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shortest: </span><span class="si">{</span><span class="n">shortest</span><span class="si">:</span><span class="s2">&gt;4.0%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Longest: 108%
Shortest:  89%
</pre></div>
</div>
</div>
</div>
<p>Now, imagine that the program’s requirements change, and I need to also determine the average length, median length, and total population size of the alligators. I can do this by expanding the <code class="docutils literal notranslate"><span class="pre">get_stats</span></code> function to also calculate these statistics and return them in the result tuple that is unpacked by the caller:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_stats</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">minimum</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">maximum</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">/</span> <span class="n">count</span>

    <span class="n">sorted_numbers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="n">middle</span> <span class="o">=</span> <span class="n">count</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">sorted_numbers</span><span class="p">[</span><span class="n">middle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">sorted_numbers</span><span class="p">[</span><span class="n">middle</span><span class="p">]</span>
        <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower</span> <span class="o">+</span> <span class="n">upper</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">median</span> <span class="o">=</span> <span class="n">sorted_numbers</span><span class="p">[</span><span class="n">middle</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">count</span>


<span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min: </span><span class="si">{</span><span class="n">minimum</span><span class="si">}</span><span class="s2">, Max: </span><span class="si">{</span><span class="n">maximum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average: </span><span class="si">{</span><span class="n">average</span><span class="si">}</span><span class="s2">, Median: </span><span class="si">{</span><span class="n">median</span><span class="si">}</span><span class="s2">, Count </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">minimum</span> <span class="o">==</span> <span class="mi">60</span>
<span class="k">assert</span> <span class="n">maximum</span> <span class="o">==</span> <span class="mi">73</span>
<span class="k">assert</span> <span class="n">average</span> <span class="o">==</span> <span class="mf">67.5</span>
<span class="k">assert</span> <span class="n">median</span> <span class="o">==</span> <span class="mf">68.5</span>
<span class="k">assert</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Min: 60, Max: 73
Average: 67.5, Median: 68.5, Count 10
</pre></div>
</div>
</div>
</div>
<p>There are two problems with this code. First, all the return values are numeric, so it is all too easy to reorder them accidentally (e.g., swapping average and median), which can cause bugs that are hard to spot later. Using a large number of return values is extremely error prone.</p>
<p>Second, the line that calls the function and unpacks the values is long, and it likely will need to be wrapped in one of a variety of ways, which hurts readability.</p>
<p>To avoid these problems, you should never use more than three variables when unpacking the multiple return values from a function. These could be individual values from a three-tuple, two variables and one catch-all starred expression, or anything shorter. If you need to unpack more return values than that, you’re better off defining a <code class="docutils literal notranslate"><span class="pre">dataclass</span></code> or <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> and having your function return an instance of that instead.</p>
</div>
<div class="section" id="use-none-and-docstrings-to-specify-dynamic-default-arguments-ep-24">
<h3>#12. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> and docstrings to specify dynamic default arguments (EP #24)<a class="headerlink" href="#use-none-and-docstrings-to-specify-dynamic-default-arguments-ep-24" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you need to use a non-static type as a keyword argument’s default value. For example, say that I want to load a value encoded as JSON data; if decoding the data fails, I want an empty dictionary to be returned by default:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>


<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">default</span>
</pre></div>
</div>
</div>
</div>
<p>The problem here is that dictionary specified for <code class="docutils literal notranslate"><span class="pre">default</span></code> will be shared by all calls to <code class="docutils literal notranslate"><span class="pre">decode</span></code> because default argument values are evaluated only once (at module load time). This can cause extremely surprising behavior:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="s2">&quot;bad data&quot;</span><span class="p">)</span>
<span class="n">foo</span><span class="p">[</span><span class="s2">&quot;stuff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="s2">&quot;also bad&quot;</span><span class="p">)</span>
<span class="n">bar</span><span class="p">[</span><span class="s2">&quot;meep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Foo:&quot;</span><span class="p">,</span> <span class="n">foo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bar:&quot;</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Foo: {&#39;stuff&#39;: 5, &#39;meep&#39;: 1}
Bar: {&#39;stuff&#39;: 5, &#39;meep&#39;: 1}
</pre></div>
</div>
</div>
</div>
<p>You might expect two different dictionaries, each with a single key and value. But modifying one seems to also modify the other. The culprit is that <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> are both equal to the default parameter. They are the same dictionary object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span> <span class="ow">is</span> <span class="n">bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>The fix is to set the keyword argument default value to None and then document the behavior in the function’s docstring:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load JSON data from a string.</span>

<span class="sd">    Args:</span>
<span class="sd">         data: JSON data to decode.</span>
<span class="sd">         default: Value to return if decoding fails.</span>
<span class="sd">             Defaults to an empty dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">return</span> <span class="n">default</span>
</pre></div>
</div>
</div>
</div>
<p>Now, running the same test code as before produces the expected result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="s2">&quot;bad data&quot;</span><span class="p">)</span>
<span class="n">foo</span><span class="p">[</span><span class="s2">&quot;stuff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="s2">&quot;also bad&quot;</span><span class="p">)</span>
<span class="n">bar</span><span class="p">[</span><span class="s2">&quot;meep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Foo:&quot;</span><span class="p">,</span> <span class="n">foo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bar:&quot;</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Foo: {&#39;stuff&#39;: 5}
Bar: {&#39;meep&#39;: 1}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>So remember:</p>
<ul class="simple">
<li><p>A default argument value is evaluated only once: during function definition at module load time. This can cause odd behaviors for dynamic values (like <code class="docutils literal notranslate"><span class="pre">{}</span></code>, <code class="docutils literal notranslate"><span class="pre">[]</span></code>, or <code class="docutils literal notranslate"><span class="pre">datetime.now()</span></code>).</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">None</span></code> as the default value for any keyword argument that has a dynamic value. Document the actual default behavior in the function’s docstring.</p></li>
</ul>
</div>
</div>
<div class="section" id="comprehensions">
<h2>Comprehensions<a class="headerlink" href="#comprehensions" title="Permalink to this headline">¶</a></h2>
<p><a id='item13'></a></p>
<div class="section" id="use-comprehensions-instead-of-map-and-filter-ep-27">
<h3>#13. Use comprehensions instead of <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">filter</span></code> (EP #27)<a class="headerlink" href="#use-comprehensions-instead-of-map-and-filter-ep-27" title="Permalink to this headline">¶</a></h3>
<p>Python provides compact syntax for deriving a new <code class="docutils literal notranslate"><span class="pre">list</span></code> from another sequence or iterable. These expressions are called list comprehensions. For example, say that I want to compute the square of each number in a <code class="docutils literal notranslate"><span class="pre">list</span></code>. Here, I do this by using a simple <code class="docutils literal notranslate"><span class="pre">for</span></code> loop:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
    <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squares</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
</pre></div>
</div>
</div>
</div>
<p>With a list comprehension, I can achieve the same outcome by specifying the expression for my computation along with the input sequence to loop over:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>  <span class="c1"># List comprehension</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squares</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
</pre></div>
</div>
</div>
</div>
<p>Unless you’re applying a single-argument function, list comprehensions are also clearer than the <code class="docutils literal notranslate"><span class="pre">map</span></code> built-in function for simple cases. <code class="docutils literal notranslate"><span class="pre">map</span></code> requires the creation of a lambda function for the computation, which is visually noisy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">map</span></code>, list comprehensions let you easily filter items from the input list, removing corresponding outputs from the result. For example, say I want to compute the squares of the numbers that are divisible by 2. Here, I do this by adding a conditional expression to the list comprehension after the loop:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">even_squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">even_squares</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 16, 36, 64, 100]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">filter</span></code> built-in function can be used along with map to achieve the same outcome, but it is much harder to read:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">even_squares</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Dictionaries and sets have their own equivalents of list comprehensions (called <em>dictionary comprehensions</em> and <em>set comprehensions</em>, respectively). These make it easy to create other types of derivative data structures when writing algorithms:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note both dictionairy and set comprehensions use {} which may be confusing at first</span>
<span class="n">even_squares_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">threes_cubed_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">even_squares_dict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">threes_cubed_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{2: 4, 4: 16, 6: 36, 8: 64, 10: 100}
{216, 729, 27}
</pre></div>
</div>
</div>
</div>
<p>Achieving the same outcome is possible with map and filter if you wrap each call with a corresponding constructor. These statements get so long that you have to break them up across multiple lines, which is even noisier and should be avoided:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">)))</span>
<span class="n">alt_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="avoid-more-than-two-control-subexpressions-in-comprehensions-ep-28">
<h3>#14. Avoid more than two control subexpressions in comprehensions (EP #28)<a class="headerlink" href="#avoid-more-than-two-control-subexpressions-in-comprehensions-ep-28" title="Permalink to this headline">¶</a></h3>
<p>Beyond basic usage, comprehensions support multiple levels of looping. For example, say that I want to simplify a matrix (a <code class="docutils literal notranslate"><span class="pre">list</span></code> containing other <code class="docutils literal notranslate"><span class="pre">list</span></code> instances) into one flat <code class="docutils literal notranslate"><span class="pre">list</span></code> of all cells. Here, I do this with a list comprehension by including two for subexpressions. These subexpressions run in the order provided, from left to right:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="n">flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">matrix</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div>
</div>
</div>
</div>
<p>This example is simple, readable, and a reasonable usage of multiple loops in a comprehension. Another reasonable usage of multiple loops involves replicating the two-level-deep layout of the input <code class="docutils literal notranslate"><span class="pre">list</span></code>. For example, say that I want to square the value in each cell of a twodimensional matrix. This comprehension is noisier because of the extra <code class="docutils literal notranslate"><span class="pre">[]</span></code> characters, but it’s still relatively easy to read:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squared</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squared</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1, 4, 9], [16, 25, 36], [49, 64, 81]]
</pre></div>
</div>
</div>
</div>
<p>If this comprehension included another loop, it would get so long that I’d have to split it over multiple lines:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_lists</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
<span class="p">]</span>
<span class="n">flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">sublist1</span> <span class="ow">in</span> <span class="n">my_lists</span> <span class="k">for</span> <span class="n">sublist2</span> <span class="ow">in</span> <span class="n">sublist1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sublist2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>At this point, the multiline comprehension isn’t much shorter than the alternative. Here, I produce the same result using normal loop statements. The indentation of this version makes the looping clearer than the three-level-list comprehension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">sublist1</span> <span class="ow">in</span> <span class="n">my_lists</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">sublist2</span> <span class="ow">in</span> <span class="n">sublist1</span><span class="p">:</span>
        <span class="n">flat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Comprehensions support multiple <code class="docutils literal notranslate"><span class="pre">if</span></code> conditions. Multiple conditions at the same loop level have an implicit <code class="docutils literal notranslate"><span class="pre">and</span></code> expression. For example, say that I want to filter a <code class="docutils literal notranslate"><span class="pre">list</span></code> of numbers to only even values greater than 4. These two list comprehensions are equivalent:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Conditions can be specified at each level of looping after the <code class="docutils literal notranslate"><span class="pre">for</span></code> subexpression. For example, say I want to filter a matrix so the only cells remaining are those divisible by 3 in rows that sum to 10 or higher. Expressing this with a list comprehension does not require a lot of code, but it is extremely difficult to read:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="n">filtered</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">matrix</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[6], [9]]
</pre></div>
</div>
</div>
</div>
<p>Although this example is a bit convoluted, in practice you’ll see situations arise where such comprehensions seem like a good fit. I strongly encourage you to avoid using <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code>, or <code class="docutils literal notranslate"><span class="pre">set</span></code> comprehensions that look like this. The resulting code is very difficult for new readers to understand. The potential for confusion is even worse for dict comprehensions since they already need an extra parameter to represent both the key and the value for each item.</p>
<p>The rule of thumb is to avoid using more than two control subexpressions in a comprehension. This could be two conditions, two loops, or one condition and one loop. As soon as it gets more complicated than that, you should use normal if and for statements and write a helper function.</p>
</div>
</div>
<div class="section" id="pandas">
<h2>pandas<a class="headerlink" href="#pandas" title="Permalink to this headline">¶</a></h2>
<div class="section" id="be-aware-of-memory-consumption-and-downcast-where-necessary">
<h3>#15. Be aware of memory consumption and downcast where necessary<a class="headerlink" href="#be-aware-of-memory-consumption-and-downcast-where-necessary" title="Permalink to this headline">¶</a></h3>
<p>We already covered this in our discussion of the Ames Housing case. We will only include the code for reference how to reduce your memory footprint of dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/jads-nl/discover-projects/blob/main/ames-housing/AmesHousing.csv?raw=true&quot;</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1922208
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># objects to categorical</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span>
    <span class="n">include</span><span class="o">=</span><span class="s2">&quot;object&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

<span class="c1"># convert integers to smallest unsigned integer and floats to smallest</span>
<span class="k">for</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="p">[(</span><span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;unsigned&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">)]:</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">old</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">downcast</span><span class="o">=</span><span class="n">new</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>419054
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-loc-and-iloc-for-indexing-dataframes-and-forget-about-ix">
<h3>#16. Use <code class="docutils literal notranslate"><span class="pre">.loc</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> for indexing dataframes (and forget about <code class="docutils literal notranslate"><span class="pre">.ix</span></code>)<a class="headerlink" href="#use-loc-and-iloc-for-indexing-dataframes-and-forget-about-ix" title="Permalink to this headline">¶</a></h3>
<p>One-third of the top-15 voted <a class="reference external" href="http://stackoverflow.com/questions/tagged/pandas?sort=votes&amp;pageSize=15">pandas questions on Stackoverflow</a> are about indexing. Another one-third are about slicing. This seems as good a place as any to start.</p>
<p>By indexing, we mean the selection of subsets of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> or <code class="docutils literal notranslate"><span class="pre">Series</span></code>. <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> (and to a lesser extent, <code class="docutils literal notranslate"><span class="pre">Series</span></code>) provide a difficult set of challenges:</p>
<ul class="simple">
<li><p>Like lists, you can index by location.</p></li>
<li><p>Like dictionaries, you can index by label.</p></li>
<li><p>Like NumPy arrays, you can index by boolean masks.</p></li>
<li><p>Any of these indexers could be scalar indexes, or they could be arrays, or they could be slices.</p></li>
<li><p>Any of these should work on the index (row labels) or columns of a DataFrame.</p></li>
<li><p>And any of these should work on hierarchical indexes.</p></li>
</ul>
<p>The complexity of pandas’ indexing is a microcosm for the complexity of the pandas API in general. There’s a reason for the complexity (well, most of it), but that’s not much consolation while you’re learning. Still, all of these ways of indexing really are useful enough to justify their inclusion in the library.</p>
<p>Since pandas 0.12, these tasks have been cleanly separated into two methods:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> for label-based indexing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.iloc</span></code> for positional indexing</p></li>
</ol>
<p>Previously, <code class="docutils literal notranslate"><span class="pre">.ix</span></code> was used to handle both cases. You may encounter this in old blog-posts. <code class="docutils literal notranslate"><span class="pre">.ix</span></code> is deprecated, so stop using it.</p>
<p>For more details, please read any (or all) of the following online tutorials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://realpython.com/pandas-python-explore-dataset/">Using Pandas and Python To Explore Your Dataset</a> on Real Python;</p></li>
<li><p><a class="reference external" href="https://github.com/jads-nl/PythonDataScienceHandbook/blob/8a34a4f653bdbdc01415a94dc20d4e9b97438965/notebooks/03.02-Data-Indexing-and-Selection.ipynb">Data Indexing and Slicing notebok</a> by Jake VanderPlas</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#different-choices-for-indexing">pandas documentation on indexing and selecting data</a></p></li>
</ul>
</div>
<div class="section" id="use-method-chaining-to-make-your-data-preparation-more-readable">
<h3>#17. Use method chaining to make your data preparation more readable<a class="headerlink" href="#use-method-chaining-to-make-your-data-preparation-more-readable" title="Permalink to this headline">¶</a></h3>
<p>Method chaining, where you call methods on an object one after another, is in vogue at the moment. It’s always been a style of programming that’s been possible with pandas:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.assign.html">assign</a> (0.16.0): For adding new columns to a DataFrame in a chain (inspired by dplyr’s mutate)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pipe.html">pipe</a> (0.16.2): For including user-defined methods in method chains.</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html">rename</a> (0.18.0): For altering axis names (in additional to changing the actual labels as before).</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/window.html">Window methods</a> (0.18): Took the top-level pd.rolling_* and pd.expanding_* functions and made them NDFrame methods with a groupby-like API.</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.resample.html">Resample</a> (0.18.0) Added a new groupby-like API</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/indexing.html#selection-by-callable">selection by callable</a> (0.18.1): You can pass a callable to the indexing methods, to be evaluated within the DataFrame’s context (like .query, but with code instead of strings).</p></li>
</ul>
<p>To illustrate the potential of method chaining, let’s look at this example with the Titanic dataset which explores the data of passengers that have embarked in Southampton:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="n">TITANIC_DATA</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/BindiChen/machine-learning/blob/master/data-analysis/007-method-chaining/data/train.csv?raw=true&quot;</span>
<span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;12&quot;</span><span class="p">,</span> <span class="s2">&quot;Teen&quot;</span><span class="p">,</span> <span class="s2">&quot;Adult&quot;</span><span class="p">,</span> <span class="s2">&quot;Older&quot;</span><span class="p">]</span>

<span class="n">pclass_age_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">replace_age_na</span><span class="p">(</span><span class="n">x_df</span><span class="p">,</span> <span class="n">fill_map</span><span class="p">):</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">x_df</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">x_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="s2">&quot;Pclass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">fill_map</span><span class="p">)</span>
    <span class="n">x_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
    <span class="k">return</span> <span class="n">x_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_southampton</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TITANIC_DATA</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">replace_age_na</span><span class="p">,</span> <span class="n">pclass_age_map</span><span class="p">)</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Embarked == &quot;S&quot;&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ageGroup</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">))</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s2">&quot;Survived&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;ageGroup&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Class </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2%}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">view_southampton</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_bf232">
  <thead>
    <tr>
      <th class="index_name level0" ></th>
      <th id="T_bf232_level0_col0" class="col_heading level0 col0" >Class 1</th>
      <th id="T_bf232_level0_col1" class="col_heading level0 col1" >Class 2</th>
      <th id="T_bf232_level0_col2" class="col_heading level0 col2" >Class 3</th>
    </tr>
    <tr>
      <th class="index_name level0" >ageGroup</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_bf232_level0_row0" class="row_heading level0 row0" ><12</th>
      <td id="T_bf232_row0_col0" class="data row0 col0" >75.00%</td>
      <td id="T_bf232_row0_col1" class="data row0 col1" >100.00%</td>
      <td id="T_bf232_row0_col2" class="data row0 col2" >37.14%</td>
    </tr>
    <tr>
      <th id="T_bf232_level0_row1" class="row_heading level0 row1" >Teen</th>
      <td id="T_bf232_row1_col0" class="data row1 col0" >80.00%</td>
      <td id="T_bf232_row1_col1" class="data row1 col1" >40.00%</td>
      <td id="T_bf232_row1_col2" class="data row1 col2" >17.78%</td>
    </tr>
    <tr>
      <th id="T_bf232_level0_row2" class="row_heading level0 row2" >Adult</th>
      <td id="T_bf232_row2_col0" class="data row2 col0" >58.10%</td>
      <td id="T_bf232_row2_col1" class="data row2 col1" >40.77%</td>
      <td id="T_bf232_row2_col2" class="data row2 col2" >16.61%</td>
    </tr>
    <tr>
      <th id="T_bf232_level0_row3" class="row_heading level0 row3" >Older</th>
      <td id="T_bf232_row3_col0" class="data row3 col0" >25.00%</td>
      <td id="T_bf232_row3_col1" class="data row3 col1" >33.33%</td>
      <td id="T_bf232_row3_col2" class="data row3 col2" >50.00%</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_string</span> <span class="o">=</span> <span class="s1">&#39;sdfjghsdfgjk&#39;</span>

<span class="k">def</span> <span class="nf">clean_string</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_string</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.&lt;lambda&gt;(s)&gt;
</pre></div>
</div>
</div>
</div>
<p>Read more on method chaining in these tutorials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://towardsdatascience.com/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac">Best practice method chaining</a> by B. Chen (with the Titanic example).</p></li>
<li><p><a class="reference external" href="https://tomaugspurger.github.io/method-chaining">Tom Augspurger’s explanation on method chaining</a> goes a bit more in depth on the reasoning and rationale behind it.</p></li>
</ul>
</div>
<div class="section" id="don-t-use-inplace-true-operations-on-dataframes">
<h3>#18. Don’t use <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> operations on dataframes<a class="headerlink" href="#don-t-use-inplace-true-operations-on-dataframes" title="Permalink to this headline">¶</a></h3>
<p>Most pandas methods have an <code class="docutils literal notranslate"><span class="pre">inplace</span></code> keyword that’s <code class="docutils literal notranslate"><span class="pre">False</span></code> by default. In general, you shouldn’t do inplace operations.</p>
<p>First, if you like method chains then you simply can’t use inplace since the return value is <code class="docutils literal notranslate"><span class="pre">None</span></code>, terminating the chain.</p>
<p>Second, I suspect people have a mental model of inplace operations happening, you know, inplace. That is, extra memory doesn’t need to be allocated for the result. But that might not actually be true. Quoting Jeff Reback from that answer</p>
<blockquote>
<div><p>Their is no guarantee that an inplace operation is actually faster. Often they are actually the same operation that works on a copy, but the top-level reference is reassigned.</p>
</div></blockquote>
<p>That is, the pandas code might look something like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dataframe_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># regardless of inplace</span>
    <span class="n">result</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_inplace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>There’s a lot of defensive copying in pandas. Part of this comes down to pandas being built on top of NumPy, and not having full control over how memory is handled and shared. Without the copy, adding the columns would modify the input DataFrame, which just isn’t polite.</p>
<p>Finally, inplace operations don’t make sense in projects like ibis or dask, where you’re manipulating expressions or building up a DAG of tasks to be executed, rather than manipulating the data directly.</p>
</div>
<div class="section" id="use-query-and-eval-for-fast-complex-indexing">
<h3>#19. Use  <code class="docutils literal notranslate"><span class="pre">.query</span></code>  and <code class="docutils literal notranslate"><span class="pre">eval</span></code> for fast, complex indexing<a class="headerlink" href="#use-query-and-eval-for-fast-complex-indexing" title="Permalink to this headline">¶</a></h3>
<p>The power of the PyData stack is built upon the ability of NumPy and pandas to push basic operations into C via an intuitive syntax: examples are vectorized/broadcasted operations in NumPy, and grouping-type operations in pandas. While these abstractions are efficient and effective for many common use cases, they often rely on the creation of temporary intermediate objects, which can cause undue overhead in computational time and memory use.</p>
<p>As of version 0.13 (released January 2014), pandas includes some experimental tools that allow you to directly access C-speed operations without costly allocation of intermediate arrays. These are the <code class="docutils literal notranslate"><span class="pre">eval()</span></code> and <code class="docutils literal notranslate"><span class="pre">query()</span></code> functions, which rely on the Numexpr package.</p>
<p>Please refer to the following notebooks and documentation on how and when to use them:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/jads-nl/PythonDataScienceHandbook/blob/8a34a4f653bdbdc01415a94dc20d4e9b97438965/notebooks/03.12-Performance-Eval-and-Query.ipynb">High-Performance Pandas: eval() and query()</a> by Jake VanderPlas</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method">pandas user guide on the query() method</a></p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./handson-ml2/extra"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="overfitting.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Overfitting vs. underfitting</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../original/math_linear_algebra.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Math primer - Linear Algebra</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Daniel Kapitan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>