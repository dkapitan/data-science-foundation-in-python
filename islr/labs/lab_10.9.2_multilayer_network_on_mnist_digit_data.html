

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lab 10.9.2: A Multilayer Network on the MNIST Digit Data &#8212; Data Science Foundation in Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'islr/labs/lab_10.9.2_multilayer_network_on_mnist_digit_data';</script>
    <link rel="canonical" href="https://jads-nl.github.io/data-science-foundation-curriculum/islr/labs/lab_10.9.2_multilayer_network_on_mnist_digit_data.html" />
    <link rel="shortcut icon" href="../../_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 10.9.3: Convolutional Neural Networks" href="lab_10.9.3_convolutional_neural_networks.html" />
    <link rel="prev" title="Lab 9.6: Support Vector Machines" href="lab_09.6_support_vector_machines.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/eaisi-logo.jpeg" class="logo__image only-light" alt="Data Science Foundation in Python - Home"/>
    <script>document.write(`<img src="../../_static/eaisi-logo.jpeg" class="logo__image only-dark" alt="Data Science Foundation in Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Why this JupyterBook?
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Statistical Learning</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction to ISLRv2</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../labs.html">Labs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="lab_02.3_introduction.html">Lab 2.3: Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_03.6_linear_regression.html">Lab 3.6: Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_04.7_classification_methods.html">Lab 4.7: Classification Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_05.3_cross_validation_and_the_bootstrap.html">Lab 5.3: Cross-Validation and the Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_06.5.1_subset_selection_methods.html">Lab 6.5.1: Subset Selection Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_06.5.2_ridge_regression_and_the_lasso.html">Lab 6.5.2: Ridge Regression and the Lasso</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_06.5.3_pcr_and_pls_regression.html">Lab 6.5.3: PCR and PLS Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_07.8_non_linear_modelling.html">Lab 7.8: Non-linear Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_08.3_decision_trees.html">Lab 8.3: Decision Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_09.6_support_vector_machines.html">Lab 9.6: Support Vector Machines</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Lab 10.9.2: A Multilayer Network on the MNIST Digit Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_10.9.3_convolutional_neural_networks.html">Lab 10.9.3: Convolutional Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_10.9.5_imdb_document_classification.html">Lab 10.9.5: IMDb Document Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_10.9.6_recurrent_neural_networks.html">Lab 10.9.6: Recurrent Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_12.5_unsupervised_learning.html">Lab 12.5: Unsupervised Learning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter2/index.html">Chapter 2</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise1.html">Exercise 2.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise2.html">Exercise 2.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise3.html">Exercise 2.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise4.html">Exercise 2.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise5.html">Exercise 2.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise6.html">Exercise 2.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise7.html">Exercise 2.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise8.html">Exercise 2.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise9.html">Exercise 2.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter2/exercise10.html">Exercise 2.10</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter3/index.html">Chapter 3</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise1.html">Exercise 3.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise2.html">Exercise 3.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise3.html">Exercise 3.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise4.html">Exercise 3.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise5.html">Exercise 3.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise6.html">Exercise 3.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise7.html">Exercise 3.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise8.html">Exercise 3.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise9.html">Exercise 3.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise10.html">Exercise 3.10</a></li>






<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise11.html">Exercise 3.11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise12.html">Exercise 3.12</a></li>



<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise13.html">Exercise 3.13</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise14.html">Exercise 3.14</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter3/exercise15.html">Exercise 3.15</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter4/index.html">Chapter 4</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise1.html">Exercise 4.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise2.html">Exercise 4.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise3.html">Exercise 4.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise4.html">Exercise 4.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise5.html">Exercise 4.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise6.html">Exercise 4.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise7.html">Exercise 4.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise8.html">Exercise 4.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise9.html">Exercise 4.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise10.html">Exercise 10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise11.html">Exercise 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise12.html">Exercise 12</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise13.html">Exercise 4.13</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise14.html">Exercise 4.11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise15.html">Exercise 4.12</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter4/exercise16.html">Exercise 4.16</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter5/index.html">Chapter 5</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise1.html">Exercise 5.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise2.html">Exercise 5.2</a></li>








<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise3.html">Problem 5.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise4.html">Exercise 5.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise5.html">Exercise 5.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise6.html">Exercise 5.6</a></li>





<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise7.html">Exercise 5.7</a></li>





<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise8.html">Exercise 5.8</a></li>







<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter5/exercise9.html">Exercise 5.9</a></li>








</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter6/index.html">Chapter 6</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise1.html">Exercise 6.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise2.html">Exercise 6.2</a></li>



<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise3.html">Exercise 6.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise4.html">Exercise 6.4</a></li>





<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise5.html">Exercise 6.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise6.html">Exercise 6.6</a></li>


<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise7.html">Exercise 6.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise8.html">Exercise 6.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise9.html">Exercise 6.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise10.html">Exercise 6.10</a></li>







<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter6/exercise11.html">Exercise 6.11</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter7/index.html">Chapter 7</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise1.html">Exercise 7.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise2.html">Exercise 7.2</a></li>





<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise3.html">Exercise 7.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise4.html">Exercise 7.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise5.html">Exercise 7.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise6.html">Exercise 7.6</a></li>



<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise7.html">Exercise 7.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise8.html">Exercise 7.8</a></li>





<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise9.html">Exercise 7.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise10.html">Exercise 7.10</a></li>


<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise11.html">Exercise 7.11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter7/exercise12.html">Exercise 7.12</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter8/index.html">Chapter 8</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise1.html">Exercise 8.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise2.html">Exercise 8.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise3.html">Exercise 8.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise4.html">Exercise 8.4</a></li>


<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise5.html">Exercise 8.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise6.html">Exercise 8.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise7.html">Exercise 8.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise8.html">Exercise 8.8</a></li>







<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise9.html">Exercise 8.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise10.html">Exercise 8.10</a></li>







<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise11.html">Exercise 8.11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter8/exercise12.html">Exercise 8.12</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter9/index.html">Chapter 9</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise1.html">Exercise 9.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise2.html">Exercise 9.2</a></li>




<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise3.html">Exercise 9.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise4.html">Exercise 9.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise5.html">Exercise 9.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise6.html">Exercise 9.6</a></li>



<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise7.html">Exercise 9.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter9/exercise8.html">Exercise 9.8</a></li>








</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../exercises/chapter12/index.html">Chapter 12</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise1.html">Exercise 12.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise2.html">Exercise 12.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise3.html">Exercise 12.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise4.html">Exercise 12.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise5.html">Exercise 12.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise6.html">Exercise 12.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise7.html">Exercise 12.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise8.html">Exercise 10.8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise9.html">Exercise 12.9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise10.html">Exercise 12.10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exercises/chapter12/exercise11.html">Exercise 12.11</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hands-on Machine Learning in Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../handson-ml2/introduction.html">Hands-on Machine Learning with Aurélien Géron</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/01_the_machine_learning_landscape.html">Chapter 1 – The Machine Learning landscape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/02_end_to_end_machine_learning_project.html">Chapter 2 – End-to-end Machine Learning project</a></li>








<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/03_classification.html">Chapter 3 – Classification</a></li>










<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/04_training_linear_models.html">Chapter 4 – Training Models</a></li>








<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/05_support_vector_machines.html">Chapter 5 – Support Vector Machines</a></li>









<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/06_decision_trees.html">Chapter 6 – Decision Trees</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/07_ensemble_learning_and_random_forests.html">Chapter 7 – Ensemble Learning and Random Forests</a></li>






<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/08_dimensionality_reduction.html">Chapter 8 – Dimensionality Reduction</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/09_unsupervised_learning.html">Chapter 9 – Unsupervised Learning</a></li>




<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/10_neural_nets_with_keras.html">Chapter 10 – Introduction to Artificial Neural Networks with Keras</a></li>












<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/11_training_deep_neural_networks.html">Chapter 11 – Training Deep Neural Networks</a></li>






<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/12_custom_models_and_training_with_tensorflow.html">Chapter 12 – Custom Models and Training with TensorFlow</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/13_loading_and_preprocessing_data.html">Chapter 13 – Loading and Preprocessing Data with TensorFlow</a></li>






<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/14_deep_computer_vision_with_cnns.html">Chapter 14 – Deep Computer Vision Using Convolutional Neural Networks</a></li>






<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/15_processing_sequences_using_rnns_and_cnns.html">Chapter 15 – Processing Sequences Using RNNs and CNNs</a></li>








<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/16_nlp_with_rnns_and_attention.html">Chapter 16 – Natural Language Processing with RNNs and Attention**</a></li>




<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/17_autoencoders_and_gans.html">Chapter 17 – Autoencoders and GANs**</a></li>












<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/18_reinforcement_learning.html">Chapter 18 – Reinforcement Learning</a></li>














<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/19_training_and_deploying_at_scale.html">Chapter 19 – Training and Deploying TensorFlow Models at Scale</a></li>








</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../handson-ml2/extra.html">Miscellaneous tips &amp; tricks</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/math_linear_algebra.html">Math primer - Linear Algebra</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/math_differential_calculus.html">Math primer - Differential Calculus</a></li>











<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/extra_autodiff.html">Implementation of autodiff techniques</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../handson-ml2/original/extra_gradient_descent_comparison.html">Comparison of Batch, Mini-Batch and Stochastic Gradient Descent</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data visualization with Altair</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../visualization/introduction.html">Data visualization with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/introduction-to-interactive-data-visualization.html">Introduction to data visualization with Python</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../visualization/altair_get_started.html">Getting Started with Altair</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_introduction.html">Introduction to Altair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_marks_encoding.html">Data Types, Graphical Marks, and Visual Encoding Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_data_transformation.html">Data Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_scales_axes_legends.html">Scales, Axes, and Legends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_view_composition.html">Multi-View Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_interaction.html">Interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_cartographic.html">Cartographic Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/altair_debugging.html">Altair Debugging Guide</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interpretable Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../iml/introduction.html">Introduction to IML</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../iml/plot_partial_dependence.html">Partial Dependence and Individual Conditional Expectation Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iml/plot_permutation_importance.html">Permutation Importance vs Random Forest Feature Importance (MDI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iml/plot_permutation_importance_multicollinear.html">Permutation Importance with Multicollinear or Correlated Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iml/interpreting-machine-learning-models.html">IML with Pima Indians and the Titanic datasets</a></li>







</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Principles of time-series forecasting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../fpp/introduction.html">Introduction to FPP3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpp/examples-time-series-forecasting-with-python.html">Examples of time-series forecasting with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Natural language processing with spaCy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../nlp/introduction.html">Introduction to NLP with spaCy</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../nlp/dutch-restaurant-reviews.html">Dutch restaurant reviews</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../nlp/nlp-dutch-restaurant-reviews.html">Analyzing Dutch restaurant reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nlp/prepare-restoreviews-dataset.html">Fetch and prepare reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nlp/nlp-pipeline-example.html">Objective</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../nlp/language-detection-with-character-quadgrams.html">Extra: language detection with character quadgrams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nlp/nlp-model-sizes.html">Extra: plot of transformer model sizes</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/jads-nl/data-science-foundation-in-python/blob/main/data_science_foundation_in_python/islr/labs/lab_10.9.2_multilayer_network_on_mnist_digit_data.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jads-nl/data-science-foundation-in-python" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jads-nl/data-science-foundation-in-python/issues/new?title=Issue%20on%20page%20%2Fislr/labs/lab_10.9.2_multilayer_network_on_mnist_digit_data.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/islr/labs/lab_10.9.2_multilayer_network_on_mnist_digit_data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 10.9.2: A Multilayer Network on the MNIST Digit Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attribution">Attribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-and-preparing-the-data">Setting up and preparing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-network">Building the network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compiling-and-training-the-model">Compiling and training the Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-the-model-s-performance">Evaluate the model’s performance</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-10-9-2-a-multilayer-network-on-the-mnist-digit-data">
<h1>Lab 10.9.2: A Multilayer Network on the MNIST Digit Data<a class="headerlink" href="#lab-10-9-2-a-multilayer-network-on-the-mnist-digit-data" title="Permalink to this heading">#</a></h1>
<section id="attribution">
<h2>Attribution<a class="headerlink" href="#attribution" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Original article by <a class="reference external" href="https://nextjournal.com/gkoehler/digit-recognition-with-keras">Gregor Koehler</a> (17-02-2020).</p></li>
<li><p>Remixed by Daniel Kapitan (08-01-2022):</p>
<ul>
<li><p>updated code for Keras Tensorflow</p></li>
<li><p>changed network layout with <span class="math notranslate nohighlight">\(K_1 = 256\)</span> and <span class="math notranslate nohighlight">\(K_2 = 128\)</span> units to match example in Introduction to Statistical Learning (2nd edition), figure 10.4 and Lab 10.9.2.</p></li>
</ul>
</li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>In this article we’ll build a simple neural network and train it to recognize handwritten digits using the MNIST dataset. Training a <em>classifier</em> on the MNIST dataset is regarded as the <em>hello world</em> of image recognition. To follow along here, you should have a basic understanding of the <a class="reference external" href="https://en.wikipedia.org/wiki/Multilayer_perceptron">Multilayer Perceptron</a> class of neural networks.</p>
<p>MNIST contains 70,000 images of handwritten digits: 60,000 for training and 10,000 for testing. The images are grayscale, 28x28 pixels, and centered to reduce preprocessing and get started quicker.</p>
<p><a class="reference external" href="https://keras.io">Keras</a> is a high-level neural network API focused on user friendliness, fast prototyping, modularity and extensibility. It works with deep learning frameworks like <a class="reference external" href="https://tensorflow.org">Tensorflow</a>, <a class="reference external" href="http://deeplearning.net/software/theano/">Theano</a> and <a class="reference external" href="https://github.com/Microsoft/CNTK">CNTK</a>, so we can get right into building and training a neural network without a lot of fuss.</p>
</section>
<section id="setting-up-and-preparing-the-data">
<h2>Setting up and preparing the data<a class="headerlink" href="#setting-up-and-preparing-the-data" title="Permalink to this heading">#</a></h2>
<p>Let’s get started by setting up our environment with Keras using Tensorflow as the backend. These package imports are pretty standard — we’ll get back to the Keras-specific imports further down. Optionally we can also import the dataset to cache it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># optionally cache the dataset</span>
<span class="c1"># %%sh</span>
<span class="c1"># python -c &#39;from tensorflow.keras.datasets import mnist</span>
<span class="c1"># mnist.load_data()&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports for array-handling and plotting</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># let&#39;s keep our keras backend tensorflow quiet</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TF_CPP_MIN_LOG_LEVEL&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;3&#39;</span>

<span class="c1"># keras imports for the dataset and building our neural network</span>
<span class="kn">from</span> <span class="nn">keras_visualizer</span> <span class="kn">import</span> <span class="n">visualizer</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Activation</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>

<span class="c1"># load the data</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    8192/11490434 [..............................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 1540096/11490434 [===&gt;..........................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 4317184/11490434 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11395072/11490434 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11490434/11490434 [==============================] - 0s 0us/step
</pre></div>
</div>
</div>
</div>
<p>Let’s inspect a few examples. The MNIST dataset contains only grayscale images. For more advanced image datasets, we’ll have the three color channels (RGB).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Digit: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/44dab770a73edac73fe46a1bcd04d1c1795961b7ae6164efd2d4582c60cec1cb.png" src="../../_images/44dab770a73edac73fe46a1bcd04d1c1795961b7ae6164efd2d4582c60cec1cb.png" />
</div>
</div>
<p>In order to train our neural network to classify images we first have to unroll the height <span class="math notranslate nohighlight">\(\times\)</span>width pixel format into one big vector - the <em>input vector</em>. So its length must be <span class="math notranslate nohighlight">\(28 \cdot 28 = 784\)</span>. But let’s graph the distribution of our pixel values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Digit: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">784</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pixel Value Distribution&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/93f4bead97fd0fb972f41e29b6a465eb98be277f54d30e4a07bf6c080079fd71.png" src="../../_images/93f4bead97fd0fb972f41e29b6a465eb98be277f54d30e4a07bf6c080079fd71.png" />
</div>
</div>
<p>As expected, the pixel values range from 0 to 255: the background majority close to 0, and those close to 255 representing the digit.</p>
<p>Normalizing the input data helps to speed up the training. Also, it reduces the chance of getting stuck in local optima, since we’re using stochastic gradient descent to find the optimal weights for the network.</p>
<p>Let’s reshape our inputs to a single vector vector and normalize the pixel values to lie between 0 and 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s print the shape before we reshape and normalize</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_train shape&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_train shape&quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_test shape&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_test shape&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># building the input vector from the 28x28 pixels</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">60000</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="c1"># normalizing the data to help with the training</span>
<span class="n">X_train</span> <span class="o">/=</span> <span class="mi">255</span>
<span class="n">X_test</span> <span class="o">/=</span> <span class="mi">255</span>

<span class="c1"># print the final input shape ready for training</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train matrix shape&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test matrix shape&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X_train shape (60000, 28, 28)
y_train shape (60000,)
X_test shape (10000, 28, 28)
y_test shape (10000,)
Train matrix shape (60000, 784)
Test matrix shape (10000, 784)
</pre></div>
</div>
</div>
</div>
<p>So far the <em>truth</em> (<em>Y</em> in machine learning lingo) we’ll use for training still holds integer values from 0 to 9.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]))
</pre></div>
</div>
</div>
</div>
<p>Let’s encode our categories - digits from 0 to 9 - using <a class="reference external" href="https://hackernoon.com/what-is-one-hot-encoding-why-and-when-do-you-have-to-use-it-e3c6186d008f">one-hot encoding</a>. The result is a vector with a length equal to the number of categories. The vector is all zeroes <em>except</em> in the position for the respective category. Thus a ‘<code class="docutils literal notranslate"><span class="pre">5</span></code>’ will be represented by <code class="docutils literal notranslate"><span class="pre">[0,0,0,0,1,0,0,0,0]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># one-hot encoding using keras&#39; numpy-related utilities</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape before one-hot encoding: &quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">Y_train</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
<span class="n">Y_test</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape after one-hot encoding: &quot;</span><span class="p">,</span> <span class="n">Y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape before one-hot encoding:  (60000,)
Shape after one-hot encoding:  (60000, 10)
</pre></div>
</div>
</div>
</div>
</section>
<section id="building-the-network">
<h2>Building the network<a class="headerlink" href="#building-the-network" title="Permalink to this heading">#</a></h2>
<p>Let’s turn to Keras to build a neural network.</p>
<p>Our pixel vector serves as the input. Then, we instantiate two hidden node layers with 256 and128 units, respectively, which is sufficiently complex for recognizing digits. For the multi-class classification we add another <em>densely-connected</em> (or <em>fully-connected</em>) layer for the 10 different output classes. For this network architecture we can use the <a class="reference external" href="https://keras.io/models/sequential/">Keras Sequential Model</a>. We can stack layers using the <code class="docutils literal notranslate"><span class="pre">.add()</span></code> method.</p>
<p>When adding the first layer in the Sequential Model we need to specify the input shape so Keras can create the appropriate matrices. For all remaining layers the shape is inferred automatically.</p>
<p>In order to introduce nonlinearities into the network and elevate it beyond the capabilities of a simple <a class="reference external" href="https://en.wikipedia.org/wiki/Perceptron">perceptron</a> we also add activation functions to the <em>hidden layers.</em> The differentiation for the training via backpropagation is happening behind the scenes without having to implement the details.</p>
<p>We also add <em>dropout</em> as a way to prevent overfitting. Here we randomly keep some network weights fixed when we would normally update them so that the network doesn’t rely too much on very few nodes.</p>
<p>The last layer consists of connections for our 10 classes and the <a class="reference external" href="https://en.wikipedia.org/wiki/Softmax_function">softmax activation</a> which is standard for multi-class targets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># building a linear stack of layers with the sequential model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>                            
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>

<span class="n">visualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;lab_10.9.2&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">14</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>
<span class="ne">---&gt; </span><span class="mi">14</span> <span class="n">visualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;lab_10.9.2&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="ne">TypeError</span>: visualizer() got an unexpected keyword argument &#39;filename&#39;
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../../_images/lab_10.9.2.png" /></p>
</section>
<section id="compiling-and-training-the-model">
<h2>Compiling and training the Model<a class="headerlink" href="#compiling-and-training-the-model" title="Permalink to this heading">#</a></h2>
<p>Now that the model is in place we configure the learning process using <code class="docutils literal notranslate"><span class="pre">.compile()</span></code>. Here we specify our <em>loss function</em> (or <em>objective function</em>). For our setting categorical cross entropy fits the bill, but in general other <a class="reference external" href="https://keras.io/losses/">loss functions</a> are available.</p>
<p>As for the <a class="reference external" href="https://keras.io/optimizers/">optimizer</a> of choice we’ll use <a class="reference external" href="https://arxiv.org/abs/1412.6980v8">Adam</a> with default settings. We could also instantiate an optimizer and set parameters before passing it to <code class="docutils literal notranslate"><span class="pre">model.compile()</span></code> but for this example the defaults will do.</p>
<p>We also choose which metrics will be evaluated during training and testing. We can pass any list of <a class="reference external" href="https://keras.io/metrics/">metrics</a> - even build metrics ourselves - and have them displayed during training/testing. We’ll stick to <em>accuracy</em> for now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compiling the sequential model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Having compiled our model we can now start the training process. We have to specify how many times we want to iterate on the whole training set (<em>epochs</em>) and how many samples we use for one update to the model’s weights (<em>batch size</em>). Generally the bigger the batch, the more stable our stochastic gradient descent updates will be. But beware of (GPU) memory limitations! We’re going for a batch size of 128 and 8 epochs.</p>
<p>To get a handle on our training progress we also graph the <em>learning curve</em> for our model looking at the loss and accuracy.</p>
<p>In order to work with the trained model and evaluate its performance we’re saving the model in a <code class="docutils literal notranslate"><span class="pre">.h5</span></code> file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># training the model and saving metrics in history</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span>
          <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
          <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">))</span>

<span class="c1"># save the model</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;keras_mnist.h5&#39;</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved trained model at </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 2s - loss: 0.3398 - accuracy: 0.8996 - val_loss: 0.1373 - val_accuracy: 0.9576 - 2s/epoch - 4ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.1409 - accuracy: 0.9581 - val_loss: 0.0979 - val_accuracy: 0.9701 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.1014 - accuracy: 0.9689 - val_loss: 0.0807 - val_accuracy: 0.9745 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0809 - accuracy: 0.9746 - val_loss: 0.0768 - val_accuracy: 0.9773 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0663 - accuracy: 0.9790 - val_loss: 0.0652 - val_accuracy: 0.9810 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0569 - accuracy: 0.9818 - val_loss: 0.0657 - val_accuracy: 0.9782 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0509 - accuracy: 0.9839 - val_loss: 0.0646 - val_accuracy: 0.9813 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0448 - accuracy: 0.9856 - val_loss: 0.0676 - val_accuracy: 0.9791 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0395 - accuracy: 0.9871 - val_loss: 0.0651 - val_accuracy: 0.9811 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0348 - accuracy: 0.9885 - val_loss: 0.0651 - val_accuracy: 0.9825 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0355 - accuracy: 0.9885 - val_loss: 0.0715 - val_accuracy: 0.9818 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0302 - accuracy: 0.9899 - val_loss: 0.0626 - val_accuracy: 0.9813 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0285 - accuracy: 0.9904 - val_loss: 0.0673 - val_accuracy: 0.9828 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0275 - accuracy: 0.9903 - val_loss: 0.0721 - val_accuracy: 0.9817 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0248 - accuracy: 0.9913 - val_loss: 0.0623 - val_accuracy: 0.9840 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0251 - accuracy: 0.9915 - val_loss: 0.0687 - val_accuracy: 0.9823 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0228 - accuracy: 0.9924 - val_loss: 0.0750 - val_accuracy: 0.9832 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0214 - accuracy: 0.9927 - val_loss: 0.0686 - val_accuracy: 0.9829 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0206 - accuracy: 0.9929 - val_loss: 0.0729 - val_accuracy: 0.9821 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 20/20
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>469/469 - 1s - loss: 0.0200 - accuracy: 0.9932 - val_loss: 0.0707 - val_accuracy: 0.9833 - 1s/epoch - 3ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saved trained model at keras_mnist.h5
CPU times: user 1min 2s, sys: 7.97 s, total: 1min 10s
Wall time: 26.6 s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/keras/src/engine/training.py:3000: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save(&#39;my_model.keras&#39;)`.
  saving_api.save_model(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting the metrics</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;model accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;model loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f3a757b8f84798a8483bfab9dda133bfbccd452c7f26066df5f1793935a08a39.png" src="../../_images/f3a757b8f84798a8483bfab9dda133bfbccd452c7f26066df5f1793935a08a39.png" />
</div>
</div>
<p>This learning curve looks quite good! We see that the loss on the training set is decreasing rapidly for the first two epochs. This shows the network is learning to classify the digits pretty fast. For the test set the loss does not decrease as fast but stays roughly within the same range as the training loss. This means our model generalizes well to unseen data.</p>
</section>
<section id="evaluate-the-model-s-performance">
<h2>Evaluate the model’s performance<a class="headerlink" href="#evaluate-the-model-s-performance" title="Permalink to this heading">#</a></h2>
<p>It’s time to reap the fruits of our neural network training. Let’s see how well we the model performs on the test set. The <code class="docutils literal notranslate"><span class="pre">model.evaluate()</span></code> method computes the loss and any metric defined when compiling the model. So in our case the accuracy is computed on the 10,000 testing examples using the network weights given by the saved model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mnist_model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;keras_mnist.h5&quot;</span><span class="p">)</span>
<span class="n">loss_and_metrics</span> <span class="o">=</span> <span class="n">mnist_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Loss&quot;</span><span class="p">,</span> <span class="n">loss_and_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Accuracy&quot;</span><span class="p">,</span> <span class="n">loss_and_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>313/313 - 0s - loss: 0.0707 - accuracy: 0.9833 - 334ms/epoch - 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test Loss 0.07070548832416534
Test Accuracy 0.983299970626831
</pre></div>
</div>
</div>
</div>
<p>This accuracy looks very good! But let’s stay neutral here and evaluate both correctly and incorrectly classified examples. We’ll look at 9 examples each.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the model and create predictions on the test set</span>
<span class="n">mnist_model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;./keras_mnist.h5&quot;</span><span class="p">)</span>
<span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">mnist_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># see which we predicted correctly and which not</span>
<span class="n">correct_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">predicted_classes</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">incorrect_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">predicted_classes</span> <span class="o">!=</span> <span class="n">y_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">correct_indices</span><span class="p">),</span><span class="s2">&quot; classified correctly&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incorrect_indices</span><span class="p">),</span><span class="s2">&quot; classified incorrectly&quot;</span><span class="p">)</span>

<span class="c1"># adapt figure size to accomodate 18 subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>

<span class="n">figure_evaluation</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># plot 9 correct predictions</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">correct</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">correct_indices</span><span class="p">[:</span><span class="mi">9</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">correct</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
      <span class="s2">&quot;Predicted: </span><span class="si">{}</span><span class="s2">, Truth: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">correct</span><span class="p">],</span>
                                        <span class="n">y_test</span><span class="p">[</span><span class="n">correct</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>

<span class="c1"># plot 9 incorrect predictions</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">incorrect</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">incorrect_indices</span><span class="p">[:</span><span class="mi">9</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">incorrect</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
      <span class="s2">&quot;Predicted </span><span class="si">{}</span><span class="s2">, Truth: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">[</span><span class="n">incorrect</span><span class="p">],</span> 
                                       <span class="n">y_test</span><span class="p">[</span><span class="n">incorrect</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>

<span class="n">figure_evaluation</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/313 [..............................] - ETA: 18s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 63/313 [=====&gt;........................] - ETA: 0s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
125/313 [==========&gt;...................] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
189/313 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
253/313 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
313/313 [==============================] - 0s 802us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9833  classified correctly
167  classified incorrectly
</pre></div>
</div>
<img alt="../../_images/6c7ec8114f11e66378819e7f396e35c99216013b8f8a274c3697dbf33fb4dc4f.png" src="../../_images/6c7ec8114f11e66378819e7f396e35c99216013b8f8a274c3697dbf33fb4dc4f.png" />
</div>
</div>
<p>As we can see, the wrong predictions are quite forgiveable since they’re in some cases even hard to recognize for the human reader.</p>
<p>In summary we used Keras with a Tensorflow backend on simpel CPU to train a neural network to recognize handwritten digits in under 3 minutes of training time - all that without having to spin up any compute instances, only using our browser.</p>
<p>In the next article of this series (coming soon) we’ll harness the power of GPUs even more to train more complex neural networks which include <a class="reference external" href="https://en.wikipedia.org/wiki/Convolutional_neural_network">convolutional layers</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./islr/labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="lab_09.6_support_vector_machines.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 9.6: Support Vector Machines</p>
      </div>
    </a>
    <a class="right-next"
       href="lab_10.9.3_convolutional_neural_networks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 10.9.3: Convolutional Neural Networks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attribution">Attribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-and-preparing-the-data">Setting up and preparing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-network">Building the network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compiling-and-training-the-model">Compiling and training the Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-the-model-s-performance">Evaluate the model’s performance</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniel Kapitan
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>